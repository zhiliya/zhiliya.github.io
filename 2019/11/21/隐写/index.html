<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="emmmm 感觉没啥好说的"><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>隐写 | zhiliya</title><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="zhiliya" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/plugins/highlight/atom-one-dark.min.css"><script type="text/javascript" src="/plugins/highlight/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();
</script><script type="text/javascript" src="/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">zhiliya</a></h1></div><p class="m-desc">心之所向，无惧无悔,<br>愿求仁得仁，复无怨怼！</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/archives/">归档</a></li><li><span class="dot">●</span><a href="/categories/">分类</a></li><li><span class="dot">●</span><a href="/tags/">标签</a></li><li><span class="dot">●</span><a href="/about/">关于</a></li><li><span class="dot">●</span><a href="/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="搜索" onfocus="if(this.value=='搜索'){this.value='';}" onblur="if(this.value==''){this.value='搜索';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">隐写</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2019/11/21/%E9%9A%90%E5%86%99/">2019-11-21</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><p>winhex去看和binwalk</p>
<p>文件属性里面最多是提示信息和解密秘钥所在</p>
<p>strings  -o  flag.xls | grep zjctf<br>dd if=1.jpg of=2.rar skip=6391983 bs=1<br>binwalk -e<br>binwalk  -D:jpeg(txt)  a.jpg -M(递归)<br>data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAACACAYAAABdhGZrAAAA<br>                      iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXN<br>比较两张图片：compare 1.jpg 2.jpg  diff.jpg<br>              cmp -l 1.jpg 2.jpg</p>
<p>制作图片马<br> <code>copy 1.jpg /b + shell.php /a shell.jpg</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">silenteye</span><br><span class="line"><span class="comment"># chr(i)返回ASCII码中整数对应的单个字符串</span></span><br><span class="line"><span class="comment"># binascii.a2b_hex 十六进制数字字符串转换为二进制数据</span></span><br><span class="line">a = <span class="string">b'worker'</span></span><br><span class="line"><span class="comment">#先把worker转换成二进制数据然后在用十六进制表示</span></span><br></pre></td></tr></table></figure>

<h4 id="tshark"><a href="#tshark" class="headerlink" title="tshark"></a>tshark</h4><blockquote>
<p> <strong><em>tshark -r x.pcapng -e http.request.uri -T fields -Y ‘http.request.uri’ | grep -P ‘name=[A-F0-9]{3}’ | awk -F ‘=’ ‘{printf $2}’</em></strong> </p>
</blockquote>
<h4 id="zsteg-png和bmp"><a href="#zsteg-png和bmp" class="headerlink" title="zsteg  png和bmp"></a>zsteg  png和bmp</h4><p>zsteg是一个可以检测png和bmp文件中隐藏数据的工具。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查看lsb数据</span><br><span class="line">zsteg xxx.bmp</span><br><span class="line">zsteg xxx.png</span><br><span class="line">检测zlib</span><br><span class="line">#-b的位数是从1开始的</span><br><span class="line">zsteg zlib.bmp -b 1 -o xy -v</span><br><span class="line">提取该通道图片</span><br><span class="line">zsteg -e b8,a,lsb,xy 文件.png -&gt; out.png</span><br></pre></td></tr></table></figure>

<p>zsteg -a file ：运行给定文件上的所有方法    #查看各个通道的lsb</p>
<p>zsteg -E file ：从给定的有效负载中提取数据（例如：zsteg -E b4，bgr，msb，xy name.png）</p>
<ul>
<li><strong>PNG &amp; BMP</strong> 中的 LSB</li>
<li>zlib 压缩数据</li>
<li><a href="http://openstego.sourceforge.net/" target="_blank" rel="noopener">OpenStego</a></li>
<li><a href="http://camouflage.unfiction.com/" target="_blank" rel="noopener">伪装 1.2.1 版</a></li>
<li>带 Eratosthenes set 的 <a href="http://wiki.cedricbonhomme.org/security%3Asteganography" target="_blank" rel="noopener">LSB。</a></li>
</ul>
<h4 id="Wavsteg"><a href="#Wavsteg" class="headerlink" title="Wavsteg"></a>Wavsteg</h4><p>WavSteg是一个python3工具，可以隐藏wav文件中的数据和文件，也可以从wav文件中提取数据。</p>
<p>你可以从<a href="https://github.com/ragibson/Steganography#WavSteg" target="_blank" rel="noopener">github</a>得到它</p>
<p>有用的命令：</p>
<p><code>python3 WavSteg.py -r -s soundfile -o outputfile</code> ：从wav声音文件中提取数据并将数据输出到新文件中</p>
<h4 id="声波可视化器"><a href="#声波可视化器" class="headerlink" title="声波可视化器"></a>声波可视化器</h4><p>声波可视化工具是一种用于查看和分析音频文件内容的工具，但在处理音频隐写时它会很有用。您可以在音频文件中显示隐藏的形状。</p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723133826028.png" alt="image-20200723133826028"></p>
<p><a href="https://www.sonicvisualiser.org/" target="_blank" rel="noopener">官方网站</a></p>
<h4 id="杂"><a href="#杂" class="headerlink" title="杂"></a>杂</h4><p>使用ImageMagic中的convert工具，将图片进行重合覆盖。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sec@sec-pc:~/1$ convert image???.jpg -background none -compose lighten -flatten output.jpg</span><br></pre></td></tr></table></figure>

<p>首先在给出的base64编码前加上data:image/jpeg;base64,/9j/</p>
<p>然后base64转图片</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">echo aGVsbG8gd29ybGQh | base64 -D</span><br><span class="line"></span><br><span class="line">使用xxd将文本从ASCII转换为16进制编码的例子：</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> hello world\! | xxd -p</span></span><br><span class="line"></span><br><span class="line">搜索PNG文件中PNG魔法字节的例子</span><br><span class="line"><span class="meta">$</span><span class="bash"> bgrep 89504e47 screenshot.png</span></span><br><span class="line">screenshot.png: 00000000</span><br><span class="line"></span><br><span class="line">使用hexdump的例子：</span><br><span class="line"><span class="meta">$</span><span class="bash"> hexdump -C screenshot.png | less</span></span><br><span class="line"></span><br><span class="line">使用hexdump格式化命令以64字节整数的16进制来输出文件前50个字节例子如下：</span><br><span class="line"><span class="meta">$</span><span class="bash"> hexdump -n 50 -e <span class="string">'"0x%08x "'</span> screenshot.png</span></span><br><span class="line"></span><br><span class="line">下载ARCHPR http://www.xue51.com/soft/4104.html</span><br><span class="line">注册码：ARCHPRP-GSVMT-66892-GKVMB-52992</span><br></pre></td></tr></table></figure>

<h2 id="JPEG-jpg-，文件头：FFD8FFE0-00-10-4A-46-49-46"><a href="#JPEG-jpg-，文件头：FFD8FFE0-00-10-4A-46-49-46" class="headerlink" title="JPEG (jpg)，文件头：FFD8FFE0 00 10 4A 46 49 46"></a>JPEG (jpg)，文件头：FFD8FFE0 00 10 4A 46 49 46</h2><p>​                    FFC0<br>​                    文件的结尾FFD9<br>​                    <del>【LSB隐写】</del></p>
<p>​                    【steghide隐写 kali steghide检测算法隐写 1.Kai里安装 sudo apt-get install steghide】 steghide extract -sf rose.jpg</p>
<p>空密码</p>
<p>​                    【outguess】</p>
<p>​                    【F5】</p>
<p>​                    【stegdetect】检查隐写算法的可能性 outguess F5 jphide<br>​                    【Stegsolve】</p>
<p>1.图片属性 </p>
<p>2.strings </p>
<p>3.010Editor分析，未发现额外的数据 </p>
<p>4.StegSolve，未发现LSB等信息 </p>
<p>5.StegDetect，未发现隐写方法。    </p>
<h2 id="GIF-gif-，文件头：-3961"><a href="#GIF-gif-，文件头：-3961" class="headerlink" title="GIF (gif)，文件头： 3961"></a>GIF (gif)，文件头： 3961</h2><p>​                            GIF89a/87a<br>​        结束：0101003B</p>
<h2 id="PNG-png-，文件头：89504E47"><a href="#PNG-png-，文件头：89504E47" class="headerlink" title="PNG (png)，文件头：89504E47"></a>PNG (png)，文件头：89504E47</h2><p>​        89504E47 0D0A1A0A0000000D 49484452 0000014B 0000012C<br>​        00 00 00 0D 说明IHDR头块长为13<br>​        49 48 44 52 IHDR 标识<br>​        00 00 01 F4 图像的宽，500像素<br>​        00 00 01 A4 图像的高，420像素<br>​        最后四位CB　D6  DF  8A为CRC校验<br>找表示宽度和高度的位置的话，可以先看看图片的属性，得到宽高值，转成16进制，搜索16进制值就找到了<br>​        注：png图片的保存恢复效果比较好，jpg貌似有点问题<br>​        png图片像    数保存是从左到右，从下往上排列的。<br>​        图像结束数据IEND(image trailer chunk)：它用来标记PNG文件或者数据流已经结束，并且必须要放在文件的尾部。</p>
<p>​        如果我们仔细观察PNG文件，我们会发现，文 件的结尾12个字符看起来总应该是这样的：<br>​        00 00 00 00 49 45 4E 44 <strong>AE 42 60 82</strong><br>​        0000000049454E44AE426082<br>​        不难明白，由于数据块结构的定义，IEND数据块的长度总是0（00 00 00 00，除非人为加入信息），数据标识总是IEND（49 45 4E 44），因此，CRC码也总是AE 42 60 82。<br>​    16进制的78 9C开头的，百度一下分析是zlib压缩的标志<br>​    【】stegsolve  【LSB隐写】 零通道有异样 上面有一行人为加上去的东西</p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723104356505.png" alt="image-20200723104356505"></p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723084719301.png" alt="image-20200723084719301"></p>
<p>​    【】binwalk foremost    </p>
<p>​    【】png图片 【LSB隐写】  cloacked-pixel工具（下载<a href="https://github.com/cyberinc/cloacked-pixel）" target="_blank" rel="noopener">https://github.com/cyberinc/cloacked-pixel）</a><br>​    cloacked-pixel在加密的过程中会删除其他数据块，只保留关键数据块IDAT<br>​    加密：python lsb.py hide big.png 1.txt 123456<br>​    hide：表示加密模式 big.png：待加密的png图片<br>​    1.txt：存放payload<br>​    123456：加密的密码<br>​    运行后生成图片big.png-stego.png<br>​    解密：python lsb.py extract big.png-stego.png 3.txt 123456<br>​    extract：表示解密模式 big.png-stego.png：待解密的png图片<br>​    3.txt：存放导出的payload<br>​    123456：解密密码<br>​    【】png图片【LSB隐写】LSB-Steganography工具<br>​    <a href="https://github.com/RobinDavid/LSB-Steganography" target="_blank" rel="noopener">https://github.com/RobinDavid/LSB-Steganography</a><br>​    加密：python LSBSteg.py -image original.png -binary original.bin -steg-out steg.png<br>​    解密：python LSBSteg.py -steg-image steg.png -out bin</p>
<p>：python lsb.py analyse big.png-stego.png</p>
<p>参数说明：</p>
<p>analyse：表示分析模式big.png-stego.png ：待分析的png图片 运行后会对图像进行分析，将其分割成块，标记每个块的最低有效位</p>
<p>crc曲线</p>
<p>下载后发现是png，打开看一下，图片模糊了。<strong>然后用hxd打开，选中开头IHDR，然后分析出crc32，发现crc32和它的crc32不同，长宽可能不正确。</strong></p>
<p><strong>用python来计算正确的长和高，以下代码基于python3，能自动算出高的问题，或者宽的问题。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import struct</span><br><span class="line">import binascii</span><br><span class="line">f &#x3D;open(&#39;flag.png&#39;,&#39;rb&#39;)</span><br><span class="line">s &#x3D;f.read()</span><br><span class="line">ihdr &#x3D; s[0xc:0x10]</span><br><span class="line">high &#x3D; s[0x10:0x14]</span><br><span class="line">weight &#x3D;s[0x14:0x18]</span><br><span class="line">a &#x3D; s[0x18:0x1d]</span><br><span class="line">crctarget &#x3D; s[0x1d:0x21]</span><br><span class="line">flag &#x3D; True</span><br><span class="line">#爆破高，通过比较crc来计算高</span><br><span class="line">for i in range(1,2048):</span><br><span class="line">    data &#x3D; ihdr+struct.pack(&#39;&gt;i&#39;,i)+weight+a</span><br><span class="line">    crc &#x3D; binascii.crc32(data)&amp;0xffffffff</span><br><span class="line">    crc &#x3D;hex(crc)</span><br><span class="line">    if crc[2:] &#x3D;&#x3D; crctarget.hex():</span><br><span class="line">        print(&quot;High wrong&quot;)</span><br><span class="line">        print(struct.pack(&#39;&gt;i&#39;,i).hex())</span><br><span class="line">        flag &#x3D; False</span><br><span class="line">        break</span><br><span class="line">#爆破宽度，通过比较crc来计算宽</span><br><span class="line">if flag :</span><br><span class="line">    for i in range(1, 2048):</span><br><span class="line">        data &#x3D; ihdr + high+ struct.pack(&#39;&gt;i&#39;, i)  + a</span><br><span class="line">        crc &#x3D; binascii.crc32(data) &amp; 0xffffffff</span><br><span class="line">        crc &#x3D; hex(crc)</span><br><span class="line">        if crc[2:] &#x3D;&#x3D; crctarget.hex():</span><br><span class="line">            print(&#39;Weight Wrong&#39;)</span><br><span class="line">            print(struct.pack(&#39;&gt;i&#39;, i).hex())</span><br><span class="line">            break</span><br><span class="line"># High wrong 000001d6</span><br></pre></td></tr></table></figure>

<h2 id="文本编码："><a href="#文本编码：" class="headerlink" title="文本编码："></a>文本编码：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#encoding</span><br><span class="line">steg&#x3D; LSBSteg(cv2.imread(&quot;my_image.png&quot;))</span><br><span class="line">img_encoded&#x3D; steg.encode_text(&quot;my message&quot;)</span><br><span class="line">cv2.imwrite(&quot;my_new_image.png&quot;,img_encoded)</span><br><span class="line"> </span><br><span class="line">#decoding</span><br><span class="line">im &#x3D;cv2.imread(&quot;my_new_image.png&quot;)</span><br><span class="line">steg&#x3D; LSBSteg(im)</span><br><span class="line">print(&quot;Textvalue:&quot;,steg.decode_text())</span><br></pre></td></tr></table></figure>



<h2 id="图像隐写："><a href="#图像隐写：" class="headerlink" title="图像隐写："></a>图像隐写：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#encoding</span><br><span class="line">steg&#x3D; LSBSteg(cv2.imread(&quot;carrier.png&quot;)</span><br><span class="line">new_im&#x3D; steg.encode_image(cv2.imread(&quot;secret_image.jpg&quot;))</span><br><span class="line">cv2.imwrite(&quot;new_image.png&quot;,new_im)</span><br><span class="line"> </span><br><span class="line">#decoding</span><br><span class="line">steg&#x3D; LSBSteg(&quot;new_image.png&quot;)</span><br><span class="line">orig_im&#x3D; steg.decode_image()</span><br><span class="line">cv.SaveImage(&quot;recovered.png&quot;,orig_im)</span><br></pre></td></tr></table></figure>



<h2 id="代码隐写："><a href="#代码隐写：" class="headerlink" title="代码隐写："></a>代码隐写：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#encoding</span><br><span class="line">steg&#x3D; LSBSteg(cv2.imread(&quot;carrier.png&quot;))</span><br><span class="line">data&#x3D; open(&quot;my_data.bin&quot;, &quot;rb&quot;).read()</span><br><span class="line">new_img&#x3D; steg.encode_binary(data)</span><br><span class="line">cv2.imwrite(&quot;new_image.png&quot;,new_img)</span><br><span class="line"> </span><br><span class="line">#decoding</span><br><span class="line">steg&#x3D; LSBSteg(cv2.imread(&quot;new_image.png&quot;))</span><br><span class="line">binary&#x3D; steg.decode_binary()</span><br><span class="line">withopen(&quot;recovered.bin&quot;, &quot;rb&quot;) as f:</span><br><span class="line">f.write(data)</span><br></pre></td></tr></table></figure>

<p>​    【】Image Steganography</p>
<h2 id="BMP"><a href="#BMP" class="headerlink" title="BMP"></a>BMP</h2><p>Windows Bitmap (bmp)，文件头：424D E3BF22 000000<br>424D D65609 000000<br>424D469000000000000046000000280000008000000090000000010010000300000000900000A00F0000A00F00000000000000000000</p>
<p>424D360C3000000000003600000028000000560500000003000001001800000000000000000000000000000000000000000000000000<br>    outguess<br>    【LSB隐写】wbStego</p>
<h2 id="ZIP-Archive-zip"><a href="#ZIP-Archive-zip" class="headerlink" title="ZIP Archive (zip)"></a>ZIP Archive (zip)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">解压缩操作经常会给出zip文件无法解压的相关有用信息</span><br><span class="line">Zipdetails -v能够根据参数提供多种信息</span><br><span class="line">Zipinfo在无需提取的情况下列出了zip文件的内容信息</span><br><span class="line">zip -F      input.zip --out output.zip和zip -FF      input.zip --out output.zip 尝试修复损坏的zip文件</span><br></pre></td></tr></table></figure>

<h3 id="1-zip伪加密-binwalk-foremost直接可以把伪加密中的文件解压出来"><a href="#1-zip伪加密-binwalk-foremost直接可以把伪加密中的文件解压出来" class="headerlink" title="1.zip伪加密//binwalk   foremost直接可以把伪加密中的文件解压出来"></a>1.zip伪加密//binwalk   foremost直接可以把伪加密中的文件解压出来</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723090021594.png" alt="image-20200723090021594"></p>
<h3 id="2-暴力破解-Ziperello和ARCHPR都可以"><a href="#2-暴力破解-Ziperello和ARCHPR都可以" class="headerlink" title="2.暴力破解 Ziperello和ARCHPR都可以"></a>2.暴力破解 Ziperello和ARCHPR都可以</h3><h3 id="3-明文攻击"><a href="#3-明文攻击" class="headerlink" title="3.明文攻击"></a>3.明文攻击</h3><p>./pkcrack -c “readme.txt” -p readme.txt  -C Desktop.zip   -P readme.zip -d decrypt.zip</p>
<p>./pkcrack -c “logo.png” -p logo.png -C flag.zip   -P logo.zip -d decrypt.zip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">./pkcrack -c <span class="string">"answer/key.txt"</span> -p readme.txt -C Desktop.zip -P readme.zip</span><br><span class="line">-C:要破解的目标文件(含路径)</span><br><span class="line"></span><br><span class="line">-c:破解文件中的明文文件的名字(其路径不包括系统路径,从zip文件一层开始)</span><br><span class="line"></span><br><span class="line">-P:压缩后的明文文件</span><br><span class="line"></span><br><span class="line">-p:压缩的明文文件中明文文件的名字(也就是readme.txt在readme.zip中的位置)</span><br><span class="line">至于其他选项参看./pkcrack --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">pkcrack还有一个重要的选项是-d，后面跟一个文件名，比如decrypt.zip，表示解密后的zip文件输出。据说这个命令可以加快解密时间，我尝试过以后发现并没有快多少，所以我花了两个小时还没跑出来密码QAQ</span><br></pre></td></tr></table></figure>

<h3 id="4-crc32碰撞"><a href="#4-crc32碰撞" class="headerlink" title="4.crc32碰撞"></a>4.crc32碰撞</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723140209998.png" alt="image-20200723140209998"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf=8</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">real = <span class="number">0x56EA988D</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1000</span>,<span class="number">9999</span>):</span><br><span class="line">    <span class="keyword">if</span> real == (binascii.crc32(str(y)) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line">        print(y)</span><br><span class="line">print(<span class="string">'End'</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python crc32.py reverse 你的crc32密文</span><br></pre></td></tr></table></figure>

<blockquote>
<p>文件头：数据区未加密504B0304140000000800</p>
<p>?               数据区真加密504B0304 1400【09】00 0800</p>
<p>?               目录区伪加密504B0102 1F001400 0900</p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723141418174.png" alt="image-20200723141418174"></p>
<p><strong>a.压缩源文件数据区：</strong></p>
<p>50 4B <strong>03 04</strong>：这是头文件标记（0x04034b50）<br>14 00：解压文件所需 pkware 版本<br><strong>00 00</strong>：全局方式位标记（有无加密）<br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>00 00：扩展记录长度<br>6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500</p>
<p><strong>b.压缩源文件目录区:</strong></p>
<p>50 4B <strong>01 02</strong>：目录中文件文件头标记(0x02014b50)<br><strong>3F 00</strong>：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br><strong>00 00</strong>：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）<br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>24 00：扩展字段长度<br>00 00：文件注释长度<br>00 00：磁盘开始号<br>00 00：内部文件属性<br>20 00 00 00：外部文件属性<br>00 00 00 00：局部头部偏移量<br>6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001</p>
<p><strong>c.压缩源文件目录结束标志:</strong></p>
<p>50 4B 05 06：目录结束标记<br>00 00：当前磁盘编号<br>00 00：目录区开始磁盘编号<br>01 00：本磁盘上纪录总数<br>01 00：目录区中纪录总数<br>59 00 00 00：目录区尺寸大小<br>3E 00 00 00：目录区对第一张磁盘的偏移量<br>00 00 1A：ZIP 文件注释长度</p>
</blockquote>
<p>?    zip爆破：kali:fcrackzip<br>?    使用fcrackzip -b -u -l 1-5 filename.zip爆破出压缩密码<br>?    不知密码长度情况下：<br>?    fcrackzip -b -c1 -u -l 1-4 test.zip<br>?    (－b 指定模式为爆破，-c1指定密码类型为纯数字，其它类型可以rtfm,-u这个参数非常重要不然不显示破解出来的密码,-l 5-6可以指定长度)</p>
<p>字典</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u crack_this.zip</span><br></pre></td></tr></table></figure>

<p>?    <a href="https://blog.csdn.net/u011500307/article/details/17371651" target="_blank" rel="noopener">https://blog.csdn.net/u011500307/article/details/17371651</a></p>
<p>TIFF (tif)，文件头：49492A00<br>RAR Archive (rar)，文件头：52617221 1A0700CF907300000D00000000000000</p>
<h2 id="rar伪加密"><a href="#rar伪加密" class="headerlink" title="rar伪加密"></a>rar伪加密</h2><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723141856821.png" alt="image-20200723141856821"></p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723142257924.png" alt="image-20200723142257924"></p>
<p>Adobe Acrobat (pdf)，文件头：255044462D312E</p>
<h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723190953321.png" alt="image-20200723190953321"></p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723191436067.png" alt="image-20200723191436067"></p>
<p>http.request.method == GET</p>
<p>  一般用Post方法传递参数</p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723191750471.png" alt="image-20200723191750471"></p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723191758273.png" alt="image-20200723191758273"></p>
<p>追踪tcp流  http流     </p>
<p>ctrl+f查找 </p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723192809773.png" alt="image-20200723192809773"></p>
<h3 id="蓝牙协议"><a href="#蓝牙协议" class="headerlink" title="蓝牙协议"></a>蓝牙协议</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723195513288.png" alt="image-20200723195513288"></p>
<h3 id="wifi"><a href="#wifi" class="headerlink" title="wifi"></a>wifi</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723201554571.png" alt="image-20200723201554571"></p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723201707897.png" alt="image-20200723201707897"></p>
<h3 id="键盘流量"><a href="#键盘流量" class="headerlink" title="键盘流量"></a>键盘流量</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723203848139.png" alt="image-20200723203848139"></p>
<h3 id="鼠标流量"><a href="#鼠标流量" class="headerlink" title="鼠标流量"></a>鼠标流量</h3><p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723203930514.png" alt="image-20200723203930514"></p>
<p>tshark -r key.pcap -T fields -e usb.capdata &gt; usbdata.txt</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#键盘流量</span></span><br><span class="line">normalKeys = &#123;<span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>, <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>, <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>, <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>, <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>, <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>, <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,<span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"'"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,<span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>, <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>, <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>, <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>, <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>, <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>, <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&amp;"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"&#123;"</span>,<span class="string">"30"</span>:<span class="string">"&#125;"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,<span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">"&lt;"</span>,<span class="string">"37"</span>:<span class="string">"&gt;"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = open(<span class="string">'usbdata.txt'</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">'0'</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">'2'</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">"00"</span>:</span><br><span class="line">             <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">'2'</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">'[unknown]'</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line">print(<span class="string">""</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a=output.index(<span class="string">'&lt;DEL&gt;'</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> output[i]==<span class="string">"&lt;CAP&gt;"</span>:</span><br><span class="line">            flag+=<span class="number">1</span></span><br><span class="line">            output.pop(i)</span><br><span class="line">            <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                flag=<span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">            output[i]=output[i].upper()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">'output :'</span> + <span class="string">""</span>.join(output))</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723210633273.png" alt="image-20200723210633273"></p>
<p>直接对pcap文件进行binwalk和foremost</p>
<h2 id="raw"><a href="#raw" class="headerlink" title="raw"></a>raw</h2><p> raw文件是内存取证工具<a href="https://www.aldeid.com/wiki/Dumpit" target="_blank" rel="noopener">Dumpit</a>提取内存生成的内存转储文件，可以使用类似Volatility等内存取证分析工具进行取证分析。 </p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200723220310464.png" alt="image-20200723220310464"></p>
<h3 id="volatility"><a href="#volatility" class="headerlink" title="volatility"></a><strong>volatility</strong></h3><p>框架是一款用于易失性内存取证的重量级框架。在该框架下我们可以完成许多取证的操作，获取我们想取得的信息。其支持的操作系统也非常广泛，同时支持  windows , linux, Mac OSX,甚至也支持 Android  手机使用ARM处理器的取证。因此，它也是所有网络取证爱好者的必学框架。 </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">volatility 使用：</span><br><span class="line">        volatility -f &lt;文件名&gt; -–profile=&lt;配置文件&gt; &lt;插件&gt; [插件参数] </span><br><span class="line">通过volatility --info获取工具所支持的profile，Address Spaces，Scanner Checks，Plugins</span><br><span class="line"></span><br><span class="line">常用插件：</span><br><span class="line">imageinfo：显示目标镜像的摘要信息，知道镜像的操作系统后，就可以在 –profile 中带上对应的操作系统</span><br><span class="line">pslist：该插件列举出系统进程，但它不能检测到隐藏或者解链的进程，psscan可以</span><br><span class="line">psscan：可以找到先前已终止(不活动)的进程以及被rootkit隐藏或解链的进程</span><br><span class="line">pstree：以树的形式查看进程列表，和pslist一样，也无法检测隐藏或解链的进程</span><br><span class="line">mendump：提取出指定进程，常用foremost 来分离里面的文件</span><br><span class="line">filescan：扫描所有的文件列表</span><br><span class="line">hashdump：查看当前操作系统中的 password hash，例如 Windows 的 SAM 文件内容</span><br><span class="line">svcscan：扫描 Windows 的服务</span><br><span class="line">connscan：查看网络连接</span><br></pre></td></tr></table></figure>





<p>2.熟悉Volatility的使用以及插件功能，发现hashdump可以将内存中的NTML提取出来： </p>
<p>volatility  hashdump  imageinfo -f 1.raw  –profile=WinXPSP2x86</p>
<p> 基于彩虹表在线NTML hash破解器<a href="http://www.objectif-securite.ch/en/ophcrack.php" target="_blank" rel="noopener">Ophcrack</a>，原理通过使用预先完成的计算结果及存储的彩虹表来加速破解hash。 </p>
<p>3.小黑在发送文件，那么一定向外建立了连接，于是便使用connscan插件（tcp连接池扫描插件）。 </p>
<p>volatility  connscan  imageinfo -f 1.raw  –profile=WinXPSP2x86</p>
<p> 可以看到本机192.168.57.21的1045与远程主机192.168.57.14的2333端口建立了连接，并且进程号为120，于是使用psscan插件（进程池扫描插件）获取跟多信息 </p>
<p><code>volatility  psscan imageinfo -f 1.raw  –profile=WinXPSP2x86</code></p>
<p> 跟踪进程号120发现是使用的是nc，同时也看到了cmd的进程，基本可以确定是使用cmd命令行的nc进行文件的传输，于是使用cmdscan插件（通过扫描_COMMAND_HISTORY提取命令历史记录）获取更多的信息： </p>
<p> volatility  cmdscan imageinfo -f 1.raw  –profile=WinXPSP2x86 </p>
<p>所以小黑是使用nc向远程主机192.168.57.14的2333发送了<a href="mailto:P@ssW0rd_is_y0ur_bir7hd4y.zip">P@ssW0rd_is_y0ur_bir7hd4y.zip</a>文件。 </p>
<p>之后便可以memdump插件（转储进程的可寻址内存数据插件）导出使用nc发送的相关数据：</p>
<p> volatility  memdump -p 120 imageinfo -f 1.raw  –profile=WinXPSP2x86  –dump-dir=outdir</p>
<p> <strong>从内存中获得密码hash</strong><br>我们需要知道system和sam key的起始位置，查找上图，copy SYSTEM和SAM位置的第一列，把输出保存到hashs.txt文件中  </p>
<p>volatility  hashdump     imageinfo -f 1.raw  –profile=WinXPSP2x86 -y 0xe1035b60 -s 0xe1469b60 &gt; hash.txt</p>
<p><img src="/2019/11/21/%E9%9A%90%E5%86%99/image-20200724152120996.png" alt="image-20200724152120996"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f 1.raw imageinfo</span><br><span class="line">volatility  -f 1.raw  --profile=WinXPSP2x86   filescan |grep  桌面</span><br><span class="line">volatility  -f 1.raw  --profile=WinXPSP2x86  dumpfiles -Q 0x000000000249ae78  --dump-dir=./</span><br><span class="line">进程扫描：volatility  psscan imageinfo -f 1.raw  –profile=WinXPSP2x86</span><br><span class="line"></span><br><span class="line">导出mspaint进程内存镜像，使用GIMP工具查看当前画图的图像</span><br><span class="line">volatility  -f 1.raw  --profile=WinXPSP2x86   memdump ‐p 332   ‐D ./       不行</span><br><span class="line">volatility  -f 1.raw  --profile=WinXPSP2x86 memdump ‐p 1056 --dump-dir=./</span><br><span class="line"></span><br><span class="line">查看进程。</span><br><span class="line">volatility pslist -f Advertising\ <span class="keyword">for</span>\ Marriage.raw</span><br><span class="line">查看记事本。</span><br><span class="line">volatility notepad -f Advertising\ <span class="keyword">for</span>\ Marriage.raw</span><br><span class="line"></span><br><span class="line">volatility -f 1.raw  –profile=WinXPSP2x86  dumpfiles -Q 0x000000002408c460 -n --dump-dir=./       -n以文件名保存</span><br><span class="line"></span><br><span class="line">对 dumpit.exe 进行分析：</span><br><span class="line">volatility -f mem.raw --profile=Win7SP1x86_23418 memdump -p 1636 -D mem/</span><br><span class="line">dump 下 dumpit.exe 的内存镜像  </span><br><span class="line">直接对dump下来的1636.dmp文件进行binwalk和foremost</span><br></pre></td></tr></table></figure>





<table>
<thead>
<tr>
<th>cmdline/cmdscan</th>
<th>列出历史 cmd 命令</th>
</tr>
</thead>
<tbody><tr>
<td>filescan</td>
<td>扫描文件，可配合 grep 使用</td>
</tr>
<tr>
<td>netscan</td>
<td>扫描建立的连接和套接字，类似于 netstat</td>
</tr>
<tr>
<td>pslist/psscan</td>
<td>列出进程列表</td>
</tr>
<tr>
<td>svcscan</td>
<td>扫描 windows 服务列表</td>
</tr>
<tr>
<td>screenshot</td>
<td>显示 GDI 样式的截屏</td>
</tr>
<tr>
<td>memdump</td>
<td>从内存 dump 进程的内存</td>
</tr>
<tr>
<td>dumpfiles</td>
<td>从内存 dump 文件</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.raw imageinfo</span><br></pre></td></tr></table></figure>

<p> 首先我们要看一下出题人在镜像里干了什么。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 pslist</span><br></pre></td></tr></table></figure>

<p>列举在缓存在内存中的注册表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.vmem --profile&#x3D;WinXPSP2x86 hivelist</span><br></pre></td></tr></table></figure>

<p>获取SAM表中的用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.vmem --profile&#x3D;WinXPSP2x86 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure>

<p>shell的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f mem.vmem   --profile&#x3D;WinXPSP2x86 volshell</span><br></pre></td></tr></table></figure>



<p>查看可疑文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 filescan</span><br></pre></td></tr></table></figure>

<p>查看文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 filescan | grep &quot;doc\|docx\|rtf&quot;</span><br><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 filescan | grep &quot;exe&quot;</span><br></pre></td></tr></table></figure>

<p>查看图片</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data  --profile&#x3D;Win7SP1x64   filescan | grep     &quot;jpg\|jpeg\|png\|tif\|gif\|bmp&quot;</span><br><span class="line">volatility -f mem.data  –-profile&#x3D;WinXPSP2x86  filescan | grep  -E &#39;jpg|png|jpeg|bmp|gif&#39;</span><br></pre></td></tr></table></figure>

<p>查看桌面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 filescan | grep &quot;Desktop&quot;</span><br></pre></td></tr></table></figure>

<p>查看截图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 screenshot --dump-dir&#x3D;.&#x2F;</span><br></pre></td></tr></table></figure>



<p>查看命令行输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 cmdline</span><br></pre></td></tr></table></figure>

<p>查看系统用户名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure>

<p>查看网络连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.data --profile&#x3D;Win7SP1x64 netscan</span><br></pre></td></tr></table></figure>





<h2 id="隐写算法-常见有F5、Guess、JSteg和JPHide等-仅限于jpg图片"><a href="#隐写算法-常见有F5、Guess、JSteg和JPHide等-仅限于jpg图片" class="headerlink" title="隐写算法 常见有F5、Guess、JSteg和JPHide等  仅限于jpg图片"></a>隐写算法 常见有F5、Guess、JSteg和JPHide等  仅限于jpg图片</h2><h3 id="F5-刷新-jpg"><a href="#F5-刷新-jpg" class="headerlink" title="F5  刷新  jpg"></a>F5  刷新  jpg</h3><p>F5隐写全称F5-steganography，在kail系统命令端输入以下代码：<br>git clone <a href="https://github.com/matthewgao/F5-steganography" target="_blank" rel="noopener">https://github.com/matthewgao/F5-steganography</a><br>wget <a href="http://ctf5.shiyanbar.com/stega/123456.jpg" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/stega/123456.jpg</a> 获取图片<br>  在命令窗口输入 java Extract /root/123456.jpg -p 123456</p>
<p>java Extract  F5.jpg  (-p 123456)</p>
<h3 id="outguess-master-猜"><a href="#outguess-master-猜" class="headerlink" title="outguess-master  猜"></a>outguess-master  猜</h3><p>在kali系统中使用outguess-master工具（需要安装），检测是否为guess算法隐写<br>    安装：cd  outguess       git clone <a href="https://github.com/crorvick/outguess" target="_blank" rel="noopener">https://github.com/crorvick/outguess</a><br>1.解压，linux下cd到outguess的文件夹<br>2.最好在root下sudo ./configure &amp;&amp; make &amp;&amp; make install 之后直接用outguess命令就可以使用了<br>    加密：<br>    outguess -k “my secret key” -d hidden.txt demo.jpg out.jpg<br>    加密之后，demo.jpg会覆盖out.jpg,hidden.txt中的内容是要隐藏的东西<br>    解密：<br>    outguess -k “my secret key” -r out.jpg hidden.txt</p>
<p>outguess -k  gemlove -r  sheng_huo_zhao_zhao.jpg  outfile.txt</p>
<p>​    解密之后，解密内容放在hidden.txt中<br>如：outguess -r angrybird.jpg outfile.txt<br>outguess -r /root/Desktop/angrybird.jpg /root/Desktop/outfile.txt</p>
<h3 id="Jshswin工具（jphide工具的一种，还有stegdetect）"><a href="#Jshswin工具（jphide工具的一种，还有stegdetect）" class="headerlink" title="Jshswin工具（jphide工具的一种，还有stegdetect）"></a>Jshswin工具（jphide工具的一种，还有stegdetect）</h3><p>Jphide是基于【最低有效位LSB】的JPEG格式图像隐写算法，使用JPEG图像作为载体是因为相比其他图像格式更不容易发现隐藏信息，因为JPEG图像在DCT变换域上进行隐藏比空间域隐藏更难检测，并且鲁棒性更强，同时Blowfish算法有较强的抗统计检测能力。<br>由于JPEG图像格式使用离散余弦变换（Discrete Cosine<br>Transform，DCT）函数来压缩图像，而这个图像压缩方法的核心是：通过识别每个8×8像素块中相邻像素中的重<br>复像素来减少显示图像所需的位数，并使用近似估算法降低其冗余度。因此，我们可以把DCT看作一个用于执行<br>压缩的近似计算方法。因为丢失了部分数据，所以DCT是一种有损压缩（Loss<br>Compression）技术，但一般不会影响图像的视觉效果。</p>
<p>steghide extract -sf rose.jpg  弱密码：123456</p>
<h3 id="图片长宽比例诡异时"><a href="#图片长宽比例诡异时" class="headerlink" title="图片长宽比例诡异时"></a>图片长宽比例诡异时</h3><p>，可以尝试改图片大小，下面介绍找图片宽度和高度的标志位的方法：<br>A）对于png文件，其第二行第六列是高度位，改这一位即可；<br>B）对于其他格式图片，可以先看看图片的属性，得到宽高值，转成16进制数，搜索该16进制值就能找到标志位了；</p>
<h2 id="杂-1"><a href="#杂-1" class="headerlink" title="杂"></a>杂</h2><p>【】磁盘取证分析环节，先下载安装好磁盘取证工具AccessData FTK Imager<br>***wav隐写-silenteye<br>wav隐写</p>
<p><strong>*avi隐写-MSU VideoStego<br>*</strong>PDF隐写-pdfdetach工具：<br>pdfdetach test.pdf -saveall（还原创建这个pdf的前一个pdf）<br>还原到第一个pdf后 pdfdetach start.pdf -save 1 -o origin.pdf</p>
<p>***vmdk隐写-Dsfok-tools，FTK<br>通常Dsfok-tools是用来编辑vmdk文件中的描述符<br>FTK直接打开文件就可以</p>
<p>***NTFS文件系统ida隐藏-ntfsinfo</p>
<p>***dmp文件隐写<br>在线分析网站：<a href="http://www.osronline.com/page.cfm?name=analyze" target="_blank" rel="noopener">http://www.osronline.com/page.cfm?name=analyze</a> </p>
<h2 id="NTFS流"><a href="#NTFS流" class="headerlink" title="NTFS流"></a>NTFS流</h2><p><code>dir</code></p>
<p><code>dir /a /r</code> 确定该目录下存在ntfs流 </p>
<ol>
<li>将损坏的ELF文件拖入hxd或其他二进制软件中，可发现Magic为0x20,0x45,0x4c,0x46，但正确的ELF文件Magic为0x7f 0x45 0x4c 0x46</li>
</ol>
<h2 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h2><p>CAD (dwg)，文件头：41433130</p>
<p>Adobe Photoshop (psd)，文件头：38425053</p>
<p>Rich Text Format (rtf)，文件头：7B5C727466</p>
<p>XML (xml)，文件头：3C3F786D6C</p>
<p>HTML (html)，文件头：68746D6C3E</p>
<p>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A</p>
<p>Outlook Express (dbx)，文件头：CFAD12FEC5FD746F</p>
<p>Outlook (pst)，文件头：2142444E</p>
<p>MS Word/Excel (xls.or.doc)，文件头：D0CF11E0</p>
<p>MS Access (mdb)，文件头：5374616E64617264204A</p>
<p>WordPerfect (wpd)，文件头：FF575043</p>
<p>Postscript (eps.or.ps)，文件头：252150532D41646F6265</p>
<p>Quicken (qdf)，文件头：AC9EBD8F</p>
<p>Windows Password (pwl)，文件头：E3828596</p>
<p>Wave (wav)，文件头：57415645</p>
<p>AVI (avi)，文件头：41564920</p>
<p>Real Audio (ram)，文件头：2E7261FD</p>
<p>Real Media (rm)，文件头：2E524D46</p>
<p>MPEG (mpg)，文件头：000001BA</p>
<p>MPEG (mpg)，文件头：000001B3</p>
<p>Quicktime (mov)，文件头：6D6F6F76</p>
<p>Windows Media (asf)，文件头：3026B2758E66CF11</p>
<p>MIDI (mid)，文件头：4D546864</p>
<p>2、从winhex中取出的文件头列表</p>
<p>File Type ExtensionsHeader</p>
<p>JPEG jpg;jpeg 0xFFD8FF</p>
<p>PNG png 0x89504E470D0A1A0A</p>
<p>GIF gif GIF8</p>
<p>TIFF tif;tiff 0x49492A00</p>
<p>TIFF tif;tiff 0x4D4D002A</p>
<p>Bit map bmp BM</p>
<p>AOL ART art 0x4A47040E000000</p>
<p>AOL ART art 0x4A47030E000000</p>
<p>PC Paintbrush pcx 0x0A050108</p>
<p>Graphics Metafile wmf 0xD7CDC69A</p>
<p>Graphics Metafile wmf 0x01000900</p>
<p>Graphics Metafile wmf 0x02000900</p>
<p>Enhanced Metafile emf 0x0100000058000000</p>
<p>Corel Draw cdr CDR</p>
<p>CAD dwg 0x41433130</p>
<p>Adobe Photoshop psd 8BPS</p>
<p>Rich Text Format rtf rtf</p>
<p>XML xml</p>
<p>HTML html;htm;PHP;php3;php4;phtml;shtml type</p>
<p>Email eml Delivery-date:</p>
<p>Outlook Express dbx 0xCFAD12FE</p>
<p>Outlookpst!BDN</p>
<p>MS Office/OLE2doc;xls;dot;ppt;xla;ppa;pps;pot;msi;sdw;db 0xD0CF11E0A1B11AE1</p>
<p>MS Access mdb;mda;mde;mdt Standard J</p>
<p>WordPerfect wpd 0xFF575043</p>
<p>OpenOffice Writer sxw writer</p>
<p>OpenOffice Calc sxc calc</p>
<p>OpenOffice Math sxm math</p>
<p>OpenOffice Impress sxi impress</p>
<p>OpenOffice Draw sxd draw</p>
<p>Adobe FrameMaker fm</p>
<ol>
<li><code>readelf -h &lt;file&gt;</code>指令，获取文件属性，可发现文件为32位可执行文件，且文件类型为ET_NONE，此处需要将文件类型修改为ET_EXEC或ET_DYN，由于难以直接确定地址，可考虑通过脚本修复。</li>
</ol>
<h2 id="elf修复"><a href="#elf修复" class="headerlink" title="elf修复"></a>elf修复</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;errno.h&gt;</span><br><span class="line">#include &lt;elf.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;mman.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;stat.h&gt;</span><br><span class="line">#include &lt;fcntl.h&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * release: gcc .&#x2F;FileFix.c -m32 -o .&#x2F;FileFix</span><br><span class="line"> * 若提示权限问题，请使用root权限执行</span><br><span class="line"> * 参考资料：《Linux二进制分析》</span><br><span class="line"> * 使用方法：FileFix &lt;filename&gt;</span><br><span class="line"> * *&#x2F;</span><br><span class="line"></span><br><span class="line">int main(int argc,char *argv[])&#123;</span><br><span class="line">    int fd;</span><br><span class="line">    uint8_t *mem;</span><br><span class="line">    struct stat st;</span><br><span class="line"> </span><br><span class="line">    Elf32_Ehdr *ehdr;</span><br><span class="line"></span><br><span class="line">    if(argc &lt; 2)&#123;</span><br><span class="line">        printf(&quot;No input file.\n&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;尝试读取文件</span><br><span class="line">    if((fd &#x3D; open(argv[1],O_RDWR)) &lt; 0)&#123;</span><br><span class="line">        perror(&quot;open&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;校验文件大小</span><br><span class="line">    if(fstat(fd, &amp;st) &lt; 0)&#123;</span><br><span class="line">        perror(&quot;fstat&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;*映射文件到内存*&#x2F;</span><br><span class="line">    mem &#x3D; mmap(NULL,st.st_size,PROT_READ | PROT_WRITE,MAP_SHARED,fd,0);</span><br><span class="line">    if(mem &#x3D;&#x3D; MAP_FAILED)&#123;</span><br><span class="line">        perror(&quot;mmap&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;*识别并修改elf各部分内容*&#x2F;</span><br><span class="line">    ehdr &#x3D; (Elf32_Ehdr *)mem;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;校验标志位</span><br><span class="line">    if(mem[0] !&#x3D; 0x7f &amp;&amp; strcmp(&amp;mem[1],&quot;ELF&quot;))&#123;</span><br><span class="line">	mem[0] &#x3D; 0x7f;</span><br><span class="line">    	mem[1] &#x3D; &#39;E&#39;;</span><br><span class="line">	mem[2] &#x3D; &#39;L&#39;;</span><br><span class="line">	mem[3] &#x3D; &#39;F&#39;;	</span><br><span class="line">        printf(&quot;File &lt;%s&gt; magic has been fixed.\n&quot;,argv[1]);        </span><br><span class="line">    &#125;else&#123;</span><br><span class="line">	printf(&quot;File &lt;%s&gt; magic do not need to fix.\n&quot;,argv[1]);    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;检验文件类型是否为可执行（ET_EXEC）</span><br><span class="line">    if(ehdr-&gt;e_type &#x3D;&#x3D; ET_NONE)&#123;</span><br><span class="line">        ehdr-&gt;e_type &#x3D; ET_EXEC;</span><br><span class="line">	printf(&quot;File &lt;%s&gt; head type has been fixed.\n&quot;,argv[1]);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        printf(&quot;File &lt;%s&gt; do not need to fix\n&quot;,argv[1]);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;写入文件</span><br><span class="line">    if(munmap((void*)mem,st.st_size) &#x3D;&#x3D; -1)&#123;</span><br><span class="line">        perror(&quot;munmap&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    printf(&quot;File &lt;%s&gt; has been fixed\n&quot;,argv[1]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="unique"><a href="#unique" class="headerlink" title="unique"></a>unique</h2><p>unique工具可以从一个密码字典中去除重复行，为我们使用密码字典进行爆破提供了很大的便利。<br>unique -v -inp=allwords.txt uniques.txt<br>Total lines read 6089 Unique lines written 5083</p>
<h2 id="john"><a href="#john" class="headerlink" title="john"></a>john</h2><p>john –format=sha512crypt shadow<br>john –wordlist=uniques.txt –format=sha512crypt shadow  //john字典暴力破解密码<br>john –show  1.txt<br>hashcat</p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">本文作者：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">zhiliya</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">本文链接：</span><span class="p-copytight-value"><a href="/2019/11/21/%E9%9A%90%E5%86%99/">http://yoursite.com/2019/11/21/隐写/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">版权声明：</span><span class="p-copytight-value">本博客所有文章除特殊声明外，均采用<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>许可协议。转载请注明出处 <a href="http://yoursite.com">zhiliya的博客</a>！</span></div></blockquote></div></article><div class="p-info box"></div><aside id="toc"><div class="toc-title">目录</div><nav><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#tshark"><span class="toc-number">1.</span> <span class="toc-text">tshark</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zsteg-png和bmp"><span class="toc-number">2.</span> <span class="toc-text">zsteg  png和bmp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Wavsteg"><span class="toc-number">3.</span> <span class="toc-text">Wavsteg</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#声波可视化器"><span class="toc-number">4.</span> <span class="toc-text">声波可视化器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#杂"><span class="toc-number">5.</span> <span class="toc-text">杂</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JPEG-jpg-，文件头：FFD8FFE0-00-10-4A-46-49-46"><span class="toc-number"></span> <span class="toc-text">JPEG (jpg)，文件头：FFD8FFE0 00 10 4A 46 49 46</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GIF-gif-，文件头：-3961"><span class="toc-number"></span> <span class="toc-text">GIF (gif)，文件头： 3961</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PNG-png-，文件头：89504E47"><span class="toc-number"></span> <span class="toc-text">PNG (png)，文件头：89504E47</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文本编码："><span class="toc-number"></span> <span class="toc-text">文本编码：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图像隐写："><span class="toc-number"></span> <span class="toc-text">图像隐写：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码隐写："><span class="toc-number"></span> <span class="toc-text">代码隐写：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BMP"><span class="toc-number"></span> <span class="toc-text">BMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZIP-Archive-zip"><span class="toc-number"></span> <span class="toc-text">ZIP Archive (zip)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-zip伪加密-binwalk-foremost直接可以把伪加密中的文件解压出来"><span class="toc-number"></span> <span class="toc-text">1.zip伪加密&#x2F;&#x2F;binwalk   foremost直接可以把伪加密中的文件解压出来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-暴力破解-Ziperello和ARCHPR都可以"><span class="toc-number"></span> <span class="toc-text">2.暴力破解 Ziperello和ARCHPR都可以</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-明文攻击"><span class="toc-number"></span> <span class="toc-text">3.明文攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-crc32碰撞"><span class="toc-number"></span> <span class="toc-text">4.crc32碰撞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rar伪加密"><span class="toc-number"></span> <span class="toc-text">rar伪加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流量分析"><span class="toc-number"></span> <span class="toc-text">流量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#蓝牙协议"><span class="toc-number"></span> <span class="toc-text">蓝牙协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wifi"><span class="toc-number"></span> <span class="toc-text">wifi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#键盘流量"><span class="toc-number"></span> <span class="toc-text">键盘流量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#鼠标流量"><span class="toc-number"></span> <span class="toc-text">鼠标流量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#raw"><span class="toc-number"></span> <span class="toc-text">raw</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#volatility"><span class="toc-number"></span> <span class="toc-text">volatility</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#隐写算法-常见有F5、Guess、JSteg和JPHide等-仅限于jpg图片"><span class="toc-number"></span> <span class="toc-text">隐写算法 常见有F5、Guess、JSteg和JPHide等  仅限于jpg图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#F5-刷新-jpg"><span class="toc-number"></span> <span class="toc-text">F5  刷新  jpg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#outguess-master-猜"><span class="toc-number"></span> <span class="toc-text">outguess-master  猜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jshswin工具（jphide工具的一种，还有stegdetect）"><span class="toc-number"></span> <span class="toc-text">Jshswin工具（jphide工具的一种，还有stegdetect）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图片长宽比例诡异时"><span class="toc-number"></span> <span class="toc-text">图片长宽比例诡异时</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#杂-1"><span class="toc-number"></span> <span class="toc-text">杂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NTFS流"><span class="toc-number"></span> <span class="toc-text">NTFS流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件头"><span class="toc-number"></span> <span class="toc-text">文件头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#elf修复"><span class="toc-number"></span> <span class="toc-text">elf修复</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unique"><span class="toc-number"></span> <span class="toc-text">unique</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#john"><span class="toc-number"></span> <span class="toc-text">john</span></a></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/2019/11/21/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/">&lt; 文件读取</a><a class="next" href="/2019/11/21/%E5%B8%B8/">常 &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//cdn.bootcdn.net/ajax/libs/valine/1.4.14/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  lang: 'zh-cn',
  placeholder:'ヾﾉ≧∀≦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright © 2016 - 2023 <a href="/." rel="nofollow">zhiliya</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/js/search.js"></script><script type="text/javascript" src="/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script></body></html>