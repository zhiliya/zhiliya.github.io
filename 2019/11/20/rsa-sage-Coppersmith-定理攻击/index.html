<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>rsa sage  Coppersmith 定理攻击 | zhiliya</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1sage -python &#x2F;path&#x2F;to&#x2F;my&#x2F;script.py  sage:1LANG&#x3D;zn jupyter notebook   Coppersmith 定理攻击，也是针对 n Coppersmith 定理指出在一个 e 阶的 mod n 多项式 f (x) 中，如果有一个根小于 n^1&#x2F;e，就可以运用一个 O (log n) 的算法求出">
<meta property="og:type" content="article">
<meta property="og:title" content="rsa sage  Coppersmith 定理攻击">
<meta property="og:url" content="http://yoursite.com/2019/11/20/rsa-sage-Coppersmith-%E5%AE%9A%E7%90%86%E6%94%BB%E5%87%BB/index.html">
<meta property="og:site_name" content="zhiliya">
<meta property="og:description" content="1sage -python &#x2F;path&#x2F;to&#x2F;my&#x2F;script.py  sage:1LANG&#x3D;zn jupyter notebook   Coppersmith 定理攻击，也是针对 n Coppersmith 定理指出在一个 e 阶的 mod n 多项式 f (x) 中，如果有一个根小于 n^1&#x2F;e，就可以运用一个 O (log n) 的算法求出">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-20T08:47:45.000Z">
<meta property="article:modified_time" content="2019-11-20T11:04:04.662Z">
<meta property="article:author" content="zhiliya">
<meta property="article:tag" content="rsa">
<meta property="article:tag" content="sage">
<meta property="article:tag" content="Coppersmith">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="zhiliya" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zhiliya</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">欢迎访问我的博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-rsa-sage-Coppersmith-定理攻击" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/20/rsa-sage-Coppersmith-%E5%AE%9A%E7%90%86%E6%94%BB%E5%87%BB/" class="article-date">
  <time datetime="2019-11-20T08:47:45.000Z" itemprop="datePublished">2019-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      rsa sage  Coppersmith 定理攻击
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sage -python &#x2F;path&#x2F;to&#x2F;my&#x2F;script.py</span><br></pre></td></tr></table></figure>

<h4 id="sage"><a href="#sage" class="headerlink" title="sage:"></a>sage:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LANG&#x3D;zn jupyter notebook</span><br></pre></td></tr></table></figure>

<p> Coppersmith 定理攻击，也是针对 n</p>
<p>Coppersmith 定理指出在一个 e 阶的 mod n 多项式 f (x) 中，如果有一个根小于 n^1/e，就可以运用一个 O (log n) 的算法求出这些根。</p>
<p>这个定理可以应用于 rsa 算法。如果 e = 3 并且在明文当中只有三分之二的比特是已知的，这种算法可以求出明文中所有的比特。<br> SageMath 还提供 Docker 映像。</p>
<ul>
<li><a href="https://hub.docker.com/r/sagemath/sage/" target="_blank" rel="noopener">sagemath /sage-Docker 集线器</a></li>
</ul>
<p>要启动可以通过 Docker 使用 SageMath 的<a href="http://d.hatena.ne.jp/keyword/bash" target="_blank" rel="noopener">bash</a> shell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --rm -i -t sagemath &#x2F; sage -sh</span><br></pre></td></tr></table></figure>









<h5 id="当素数-p-的高位或低位已知时"><a href="#当素数-p-的高位或低位已知时" class="headerlink" title="当素数 p 的高位或低位已知时"></a>当素数 p 的高位或低位已知时</h5><p>铜匠定理是获得模 N 的解，但是 Sage 的 small_root 方法<code>b &gt;= N^β</code>可以找到模 N 的除数 b 的解，这一点更加详细。此处，法则 N 中的解决方案就是<code>β = 1</code>这种情况。 <a href="http://d.hatena.ne.jp/keyword/RSA" target="_blank" rel="noopener">在 RSA 中</a>，公钥 n 的位数相同 <a href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4" target="_blank" rel="noopener">总理</a> P，考虑到为 q 的产品，<code>β = 0.3</code>由度<code>b = p or q</code>为模解决方案可以计算。</p>
<p><a href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4" target="_blank" rel="noopener">当</a>已知<a href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4" target="_blank" rel="noopener">质数</a> p 的高位是 n 的位数的 1/4，即 p 的位数的约 1/2 时，则假定其余位数为 0 <code>pbar</code>。此时<code>f(x) = x + pbar = 0 (mod b)</code>，可以通过找到 f 的解（f）来满足 f（x）的值，即 p。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># partial_p.sage</span><br><span class="line"></span><br><span class="line">p &#x3D; 0x00f23799c031b942026e420769b74d22fa2114428189139c43c366c6ab8367c6b3d6f821449aafb2058b0e6ed964fa0ad45fb306f96376e80823a72b58101919e50acad3b5e6d079e7ff9218ed6df6edbef536742714ce88b2e717f45af53ef0d04c89faf01c80b28e764973aba27726c85c0236e8756a865c03577722bac5e391</span><br><span class="line">q &#x3D; 0x00c9d24330fa4945cfe1e5d6912d6bde0231035a1cc8d8ae67d949347b895f8d579bce2adaf37c568957b17a6564dbf80d36d81e4622ab30e02132b0155aefbd3912a27c625a9b7b05bc72217039f5aa88c20cbf9871c3228e9d80d9106f94b11c1f50c40c96862b5cd6b6f781883dd2eff80a059d3ca027af6a03edeb34a7390f</span><br><span class="line">n &#x3D; p*q</span><br><span class="line">e &#x3D; 3</span><br><span class="line"></span><br><span class="line">beta &#x3D; 0.5</span><br><span class="line">epsilon &#x3D; beta^2&#x2F;7</span><br><span class="line"></span><br><span class="line">pbits &#x3D; p.nbits()</span><br><span class="line">kbits &#x3D; floor(n.nbits()*(beta^2-epsilon))</span><br><span class="line">pbar &#x3D; p &amp; (2^pbits-2^kbits)</span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + pbar</span><br><span class="line"></span><br><span class="line">print p</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.3)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.3</span><br><span class="line">print x0 + pbar</span><br></pre></td></tr></table></figure>

<p> 此处，kbits 表示未知部分的位数。实际上，在铜匠定理中有一个 ε 部分，因此需要知道的位数比 p 中位数的一半还要大。在这里，考虑到 small_roots 方法是默认方法，<code>ε = β^2/8</code>则选择适当的 kbits。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n&#x3D;0x985CBA74B3AFCF36F82079DE644DE85DD6658A2D3FB2D5C239F2657F921756459E84EE0BBC56943DE04F2A04AACE311574BE1E9391AC5B0F8DBB999524AF8DF2451A84916F6699E54AE0290014AFBF561B0E502CA094ADC3D9582EA22F857529D3DA79737F663A95767FDD87A9C19D8104A736ACBE5F4A25B2A25B4DF981F44DB2EB7F3028B1D1363C3A36F0C1B9921C7C06848984DFE853597C3410FCBF9A1B49C0F5CB0EEDDC06D722A0A7488F893D37996F9A92CD3422465F49F3035FEA6912589EFCFB5A4CF9B69C81B9FCC732D6E6A1FFCE9690F34939B27113527ABB00878806B229EC6570815C32BC2C134B0F56C21A63CA535AB467593246508CA9F9</span><br><span class="line">p&#x3D;0xBCF6D95C9FFCA2B17FD930C743BCEA314A5F24AE06C12CE62CDB6E8306A545DE468F1A23136321EB82B4B8695ECE58B763ECF8243CBBFADE0603922C130ED143D4D3E88E483529C820F7B53E4346511EB14D4D56CB2B714D3BDC9A2F2AB655993A31E0EB196E8F63028F9B29521E9B3609218BA0000000000000000000000000</span><br><span class="line">p_fake &#x3D; p+0x10000000000000000000000000</span><br><span class="line">pbits &#x3D; 1024</span><br><span class="line">kbits &#x3D; pbits-576</span><br><span class="line">pbar &#x3D; p_fake &amp; (2^pbits-2^kbits)</span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)</span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + pbar</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.4</span><br><span class="line">print x0 + pbar</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; 0x73cec712124b33c0294e01eb52e8c3cd2fe9ddbcbf457b3b950360063dfae42cbbe9855bd986bcfea0948fadfb252f5e2ff3c982ff47afb6596a496636f1fc5ecfe9f5db7620b23fe9e30d230aa9299ab9a78bfb5e0630fd1149259b2b2104ea65d2e27b89785e4bf01d0594d9f94575cbcc3383f63c5aabe4d5b48eb761cce3ab21689b3f3155b5f15efee240d5ac11cee2acbd019de7c06f607ea618b5cd735b5a6972d2b446a12ff58cf8314822fa5ea09d0963acd00441b2a1b37aca01d7f39052927db98a0bd5ca1c49a7ad67923e3aac30ecd33cc8b4b30a40cdb3acc721ee5da53a02977cee959affe672a668525eb78df96af0a14f4ac04fab68efa8eabe9535e1064a5fc2ff7cac9520210311db0c3bf91101bc55a67a81e4f69364c724ee6ad6bdc301df642c9392e9befa4ff0d65481adb6feac251cd207044587da9710809700246cb3c63e659a97249f5e7418568e37db2fb2c1115e719d6682bb2e89b4e23d40ba4c532f289e10e0b89a5647c486a09b9e376844171b229d74f871004d4945a702a391a04ac704f43809e972891e6ab33b3c0f03f0b6f9ae005b26be6e647a1865c727277423f59a595187ffbfea13501e23b6b57ef115eaa6febcb207a3112628652a39578847241c33989e84607b0f683b30ddf773348b07360b063d9120a397809591ca18a04cd32ad9cbfe0494ed3ae8d2c5b43fdb51cb</span><br><span class="line">p_fake &#x3D; 25469341510015610710601677541490068882874022771473379147959682877979811860690835905177575433486769235926750944378553837429714908846121392087707617153368450157831411033840331452402635316893579428297241392591768100008774205252294780519995317089863801331600746389471563346749402400584048767782402832414560955794979239140648096754408560344380360521300295416056532504527346890878830708030202503589314586128121926254376071861981570648841288044240102936057199541504839050994656267226010545841307490110261343492485615893311098351703701000220286503350522201318815497988460167971677642567134161349144833221240627311534482202273</span><br><span class="line">pbits &#x3D; p_fake.nbits()</span><br><span class="line">kbits &#x3D; 900</span><br><span class="line">#kbits &#x3D; 200</span><br><span class="line">pbar &#x3D; p_fake &amp; (2^pbits-2^kbits)</span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)</span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + pbar</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.3</span><br><span class="line">p&#x3D; x0 + pbar</span><br><span class="line">print &#39;p &#x3D;&#39;,p</span><br></pre></td></tr></table></figure>







<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 2\n&#39; &#39;[+]n&#x3D;0x5894f869d1aecee379e2cb60ff7314d18dbd383e0c9f32e7f7b4dc8bd47535d4f3512ce6a23b0251049346fede745d116ba8d27bcc4d7c18cfbd86c7d065841788fcd600d5b3ac5f6bb1e111f265994e550369ddd86e20f615606bf21169636d153b6dfee4472b5a3cb111d0779d02d9861cc724d389eb2c07a71a7b3941da7dL\n&#39;  &#39;[+]e&#x3D;65537\n&#39; &#39;[+]m&#x3D;random.getrandbits(512)\n&#39;     &#39;[+]c&#x3D;pow(m,e,n)&#x3D;0x284a601c3321fd882d3b64ae27fb587d1714bc18aecc3293169861bcf17678a6e83947aba4f165f22a712ed42e43c66cf70eb1df4d73dd3adf1754f627b1b3ca25b76b3a595369c36b1f5635cd3efe5924539757e74840224eec238534ead0bcbdce26eb018aa33516d22790240c7576cb5a09d3f69bcf2795a3a353db7c8bedL\n&#39;     &#39;[+]((p&gt;&gt;128)&lt;&lt;128)&#x3D;0x5d33504b4e3bd2ffb628b5c447c4a7152a9f37dc4bcc8f376f64000fa96eb97c0af445e3b2c03926a4aa4542918c601000000000000000000000000000000000L</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blus.King」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;q851579181q&#x2F;article&#x2F;details&#x2F;90645041</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;0x284a601c3321fd882d3b64ae27fb587d1714bc18aecc3293169861bcf17678a6e83947aba4f165f22a712ed42e43c66cf70eb1df4d73dd3adf1754f627b1b3ca25b76b3a595369c36b1f5635cd3efe5924539757e74840224eec238534ead0bcbdce26eb018aa33516d22790240c7576cb5a09d3f69bcf2795a3a353db7c8bedL</span><br><span class="line">n &#x3D; 0x5894f869d1aecee379e2cb60ff7314d18dbd383e0c9f32e7f7b4dc8bd47535d4f3512ce6a23b0251049346fede745d116ba8d27bcc4d7c18cfbd86c7d065841788fcd600d5b3ac5f6bb1e111f265994e550369ddd86e20f615606bf21169636d153b6dfee4472b5a3cb111d0779d02d9861cc724d389eb2c07a71a7b3941da7d</span><br><span class="line">p_fake &#x3D; 0x5d33504b4e3bd2ffb628b5c447c4a7152a9f37dc4bcc8f376f64000fa96eb97c0af445e3b2c03926a4aa4542918c601000000000000000000000000000000000</span><br><span class="line">pbits &#x3D; p_fake.nbits()</span><br><span class="line">kbits &#x3D; 128</span><br><span class="line">#kbits &#x3D; 200</span><br><span class="line">pbar &#x3D; p_fake &amp; (2^pbits-2^kbits)</span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)</span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + pbar</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.3</span><br><span class="line">p&#x3D; x0 + pbar</span><br><span class="line">print &#39;p &#x3D;&#39;,p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p&#x3D;4881303325607587234201385254050033835312172878514703272072771615943902178092736544523304388539705532310101139649392707401107616606921391984907633619668131</span><br></pre></td></tr></table></figure>

<h6 id="其他exp-https-www-jianshu-com-p-1a0e876d5929-加以理解Coppersmith"><a href="#其他exp-https-www-jianshu-com-p-1a0e876d5929-加以理解Coppersmith" class="headerlink" title="其他exp:https://www.jianshu.com/p/1a0e876d5929  加以理解Coppersmith"></a>其他exp:<a href="https://www.jianshu.com/p/1a0e876d5929" target="_blank" rel="noopener">https://www.jianshu.com/p/1a0e876d5929</a>  <code>加以理解Coppersmith</code></h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">import binascii</span><br><span class="line">n &#x3D; 0x.... # 此处为16进制数</span><br><span class="line">p4 &#x3D;0x....  #p的高位 16进制</span><br><span class="line">cipher &#x3D; 0x 密文</span><br><span class="line">e2 &#x3D; 0xf93b</span><br><span class="line">pbits &#x3D; 1024</span><br><span class="line">kbits &#x3D; pbits - p4.nbits()</span><br><span class="line">print p4.nbits()</span><br><span class="line">p4 &#x3D; p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + p4</span><br><span class="line">roots &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)</span><br><span class="line">if roots:</span><br><span class="line">   p &#x3D; p4+int(roots[0])</span><br><span class="line">   print &quot;p: &quot;, hex(int(p))</span><br><span class="line">   assert n % p &#x3D;&#x3D; 0</span><br><span class="line">   q &#x3D; n&#x2F;int(p)</span><br><span class="line">   print &quot;q: &quot;, hex(int(q))</span><br><span class="line">   print gcd(p,q)</span><br><span class="line">   phin &#x3D; (p-1)*(q-1)</span><br><span class="line">   print gcd(e2,phin)</span><br><span class="line">   d &#x3D; inverse_mod(e2,phin)</span><br><span class="line">   flag &#x3D; pow(cipher,d,n)</span><br><span class="line">   flag &#x3D; hex(int(flag))[2:-1]</span><br><span class="line">   print binascii.unhexlify(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">import binascii</span><br><span class="line">n &#x3D; 0x9d3a1a28ecb1bd245dd86b18dc4c5b729f23778710005118836129f08e31d6516de8ab47db1b3b7f660f50d283b1e9f2c06e7836136e4c0159f5d2b05771861d3ce6aa8715932eadc1cc0f380909a1961018340f7393142f9c177b1187151f97ac8cdc4ad17fa59a0f39d192af555f27de9cc800846eb2ca6ce78f87c0c0fbf47828328392b81771af624389fd779d130d80739bb7a608961125ba3f1800c766440fa70bfd3f834294d47d7ed9cfffd6d14ae18310f6c1d6d8f88b6c5d72a0b45608b4e21bbb8e314220ed7a2d6a8c95454e571c71b50f1d6a823778ca47131f5b889a1ed1957248bee8c4ac66872a5fd58a121560a27bad4958f1c763f2ffddL</span><br><span class="line"></span><br><span class="line">#p4 &#x3D;0xda5df16f286dbc825cd0c8ee48aa26ac27338a75172c5b92351f14d083216f7e91b9355e27cf930646fbbda6058dec3c4ddf751f36df5556359fbe671f9b947b4c79cadfdbb27b00</span><br><span class="line"></span><br><span class="line">cipher &#x3D; 0x1f2deea59244b14e53c72465febc2064172a35245842fa83ebff313344bed35ee8af8c3f8f61e6f498fa1fd35e63998a573d7717905f72ec01de0b0529eaab10eb0b0c2ca06e9d6e4245e748fd74f4f756a86e379559793389a3ae6c421d51bb78331a487fc3c3e68971e3e26991ab34ce2a2c07ffd5a5a1e215e766b51fb2d6aab63c2dafa3c87d0a5eb79b634740e1fca7a727de997958839bda684e19acad93cae4abfd1c8cc3684419f83696fe4840f3253e7c038adb13a1382667cf7e17ef55c1e950ea474594102e660e36a23bfd3fd830d1c18a434d0b34bed98308399a894dcab909d68bcab7c7ac990974a4f6ed7d612abb7044f6734eaaebcdc0b5L</span><br><span class="line"></span><br><span class="line">e2 &#x3D; 0x10001</span><br><span class="line">pbits &#x3D; 1024</span><br><span class="line"></span><br><span class="line">for i in range(0,127):</span><br><span class="line">    p4&#x3D;0xda5df16f286dbc825cd0c8ee48aa26ac27338a75172c5b92351f14d083216f7e91b9355e27cf930646fbbda6058dec3c4ddf751f36df5556359fbe671f9b947b4c79cadfdbb27b00</span><br><span class="line">    p4&#x3D;p4+int(hex(i),16)</span><br><span class="line">    print hex(p4)</span><br><span class="line">    kbits &#x3D; pbits - p4.nbits()</span><br><span class="line">    print p4.nbits()</span><br><span class="line">    p4 &#x3D; p4 &lt;&lt; kbits</span><br><span class="line">    PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    f &#x3D; x + p4</span><br><span class="line">    roots &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)</span><br><span class="line">    #rint roots</span><br><span class="line">    if roots:</span><br><span class="line">        p &#x3D; p4+int(roots[0])</span><br><span class="line">        print &quot;p: &quot;, hex(int(p))</span><br><span class="line">        assert n % p &#x3D;&#x3D; 0</span><br><span class="line">        q &#x3D; n&#x2F;int(p)</span><br><span class="line">        print &quot;q: &quot;, hex(int(q))</span><br><span class="line">        print gcd(p,q)</span><br><span class="line">        phin &#x3D; (p-1)*(q-1)</span><br><span class="line">        print gcd(e2,phin)</span><br><span class="line">        d &#x3D; inverse_mod(e2,phin)</span><br><span class="line">        flag &#x3D; pow(cipher,d,n)</span><br><span class="line">        flag &#x3D; hex(int(flag))[2:-1]</span><br><span class="line">        print binascii.unhexlify(flag)</span><br></pre></td></tr></table></figure>





<h5 id="当秘密密钥-d-的低位已知时"><a href="#当秘密密钥-d-的低位已知时" class="headerlink" title="当秘密密钥 d 的低位已知时"></a>当秘密密钥 d 的低位已知时</h5><p> <a href="http://d.hatena.ne.jp/keyword/%C8%EB%CC%A9%B8%B0" target="_blank" rel="noopener">对于私钥</a> d，如果已知低位约为 n 位数的 1/4，则可以恢复 d 的值。有时称为部分密钥暴露攻击。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># partial_d.sage</span><br><span class="line"></span><br><span class="line">def partial_p(p0, kbits, n):</span><br><span class="line">    PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    nbits &#x3D; n.nbits()</span><br><span class="line"></span><br><span class="line">    f &#x3D; 2^kbits*x + p0</span><br><span class="line">    f &#x3D; f.monic()</span><br><span class="line">    roots &#x3D; f.small_roots(X&#x3D;2^(nbits&#x2F;&#x2F;2-kbits), beta&#x3D;0.3)  # find root &lt; 2^(nbits&#x2F;&#x2F;2-kbits) with factor &gt;&#x3D; n^0.3</span><br><span class="line">    if roots:</span><br><span class="line">        x0 &#x3D; roots[0]</span><br><span class="line">        p &#x3D; gcd(2^kbits*x0 + p0, n)</span><br><span class="line">        return ZZ(p)</span><br><span class="line"></span><br><span class="line">def find_p(d0, kbits, e, n):</span><br><span class="line">    X &#x3D; var(&#39;X&#39;)</span><br><span class="line"></span><br><span class="line">    for k in xrange(1, e+1):</span><br><span class="line">        results &#x3D; solve_mod([e*d0*X - k*X*(n-X+1) + k*n &#x3D;&#x3D; X], 2^kbits)</span><br><span class="line">        for x in results:</span><br><span class="line">            p0 &#x3D; ZZ(x[0])</span><br><span class="line">            p &#x3D; partial_p(p0, kbits, n)</span><br><span class="line">            if p:</span><br><span class="line">                return p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    n &#x3D; 0x00bef498e6eb2cffe71312da47ab89d2c47db7438ea2cfa992ddddbc2a01978001fc51e286e6ebf028396cdb8b3323c60e6b9d50cd84187cf7f48e3875a2f0890f70b02333ad89db2923863ce146562286f63fb0a1d0198e3a6862ba5ac12e85a5c6d0d27cb1c81bdf69cc5bc95b8001a2f744517f9437b4ddd5a076fc0e9a5de1a7a268c40f31aa29e8dc27c0b3a182299ca7a9335b4bd4585452f6107c238e486c98dd73a5f9862e9e80b152f53381c72f897107551c281259ac3ee32c4b4f46cc03127d1bf699acd0266f3c6729253c70da0c69b1560fa172735709866b375b6eba294e1ce8b46fba798ba380080b4bf9603998cac199d9cd46e30ae8da9e7f</span><br><span class="line">    e &#x3D; 3</span><br><span class="line">    d &#x3D; 0x7f4dbb449cc8aa9a0cb73c2fc7b1372da924d7b46c8a710c93e9281c010faaabfd8bec59ef47f5702648925cccc284099d138b33ad65a8a54db425a3c1f5b0b4f5cac22273b13cc617aed340d98ec1af4ed5206be011097c459726e72b7459192f35e1a8768567ea46883d30e7aaabc1fa2d8baa62cfcde93915a4a809bc3e9547bb07e1ecca16e51078312e89f0561e31b55db8b0ea5bc87a6ca7464a3d7c28a68c60e2ba88fe6a7d2b300d723e549910a987da89fc0a1c0de197a3d62c501b1f0e819891b1c32a0d6c233f2a285df87bb9e5c6c72d983ff3e706696bba639f573f9c3646968f02f3a615a438e20bb7c38d53621079f2899547a95350f3abeb</span><br><span class="line"></span><br><span class="line">    beta &#x3D; 0.5</span><br><span class="line">    epsilon &#x3D; beta^2&#x2F;7</span><br><span class="line"></span><br><span class="line">    nbits &#x3D; n.nbits()</span><br><span class="line">    kbits &#x3D; floor(nbits*(beta^2+epsilon)) </span><br><span class="line">    d0 &#x3D; d &amp; (2^kbits-1)  #d0 代表已知的 d 的较低位，kbits 是已知的 d0 的位数。</span><br><span class="line">    print &quot;lower %d bits (of %d bits) is given&quot; % (kbits, nbits)</span><br><span class="line"></span><br><span class="line">    p &#x3D; find_p(d0, kbits, e, n)</span><br><span class="line">    print &quot;found p: %d&quot; % p</span><br><span class="line">    q &#x3D; n&#x2F;&#x2F;p</span><br><span class="line">    print d</span><br><span class="line">    print inverse_mod(e, (p-1)*(q-1))</span><br></pre></td></tr></table></figure>

<p>上面的代码按以下顺序恢复 d 的值：</p>
<ol>
<li>根据 e，d，n 和 p 满足较低位的方程，从 d 的较低位中查找 p 较低位的候选对象</li>
<li>从 1 中获得的候选者中搜索可以使用 Coppersmith <a href="http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0" target="_blank" rel="noopener">算法</a>恢复 p 值的候选者</li>
<li>根据 p 的恢复值计算另一个<a href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4" target="_blank" rel="noopener">质数</a> q 并计算 d 的值</li>
</ol>
<p>当 p 的低位是 p0 时，图 2 <code>f(x) = 2^k * x + p0 = 0 (mod b)</code>尝试通过找到解来恢复 p 的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 3 [DEBUG] Received 0x314 bytes: [+]n&#x3D;0xd463feb999c9292e25acd7f98d49a13413df2c4e74820136e739281bb394a73f2d1e6b53066932f50a73310360e5a5c622507d8662dadaef860b3266222129fd645eb74a0207af9bd79a9794f4bd21f32841ce9e1700b0b049cfadb760993fcfc7c65eca63904aa197df306cad8720b1b228484629cf967d808c13f6caef94a9L </span><br><span class="line">[+]e&#x3D;3 </span><br><span class="line">[+]m&#x3D;random.getrandbits(512) [+]c&#x3D;pow(m,e,n)&#x3D;0xcaeeb38516d642a19550fa863173f4695c3b44bd5a5554b1e93cfb690d5c1de531b7f1187f7d8c8c11da38af025f19d393033d0ca801e15d6d8441098485f13ab988d09ef1f4f5a735e19780c823cf77415884c33a1f7908cf4229874c082eb7ceb776bafb182b86fdabd29b07bcb8e3f2f50ee4cc0f323e8d9ce320139bcd27L </span><br><span class="line">[+]d&#x3D;invmod(e,(p-1)*(q-1)) </span><br><span class="line">[+]d&amp;((1&lt;&lt;512)-1)&#x3D;0x603d033f2ef6c759aec839f132a45215fc8a635b757f3951a731fe60bc6729b3bcf819b57abfcaba3a93e9edef766c0d499cad3f7adb306bcf1645cfb63400e3L </span><br><span class="line">[-]long_to_bytes(m).encode(&#39;hex&#39;)&#x3D;</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blus.King」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;q851579181q&#x2F;article&#x2F;details&#x2F;90645041</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;0xcaeeb38516d642a19550fa863173f4695c3b44bd5a5554b1e93cfb690d5c1de531b7f1187f7d8c8c11da38af025f19d393033d0ca801e15d6d8441098485f13ab988d09ef1f4f5a735e19780c823cf77415884c33a1f7908cf4229874c082eb7ceb776bafb182b86fdabd29b07bcb8e3f2f50ee4cc0f323e8d9ce320139bcd27</span><br><span class="line"># partial_d.sage</span><br><span class="line"></span><br><span class="line">def partial_p(p0, kbits, n):</span><br><span class="line">    PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    nbits &#x3D; n.nbits()</span><br><span class="line"></span><br><span class="line">    f &#x3D; 2^kbits*x + p0</span><br><span class="line">    f &#x3D; f.monic()</span><br><span class="line">    roots &#x3D; f.small_roots(X&#x3D;2^(nbits&#x2F;&#x2F;2-kbits), beta&#x3D;0.3)  # find root &lt; 2^(nbits&#x2F;&#x2F;2-kbits) with factor &gt;&#x3D; n^0.3</span><br><span class="line">    if roots:</span><br><span class="line">        x0 &#x3D; roots[0]</span><br><span class="line">        p &#x3D; gcd(2^kbits*x0 + p0, n)</span><br><span class="line">        return ZZ(p)</span><br><span class="line"></span><br><span class="line">def find_p(d0, kbits, e, n):</span><br><span class="line">    X &#x3D; var(&#39;X&#39;)</span><br><span class="line"></span><br><span class="line">    for k in xrange(1, e+1):</span><br><span class="line">        results &#x3D; solve_mod([e*d0*X - k*X*(n-X+1) + k*n &#x3D;&#x3D; X], 2^kbits)</span><br><span class="line">        for x in results:</span><br><span class="line">            p0 &#x3D; ZZ(x[0])</span><br><span class="line">            p &#x3D; partial_p(p0, kbits, n)</span><br><span class="line">            if p:</span><br><span class="line">                return p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    n&#x3D;0xd463feb999c9292e25acd7f98d49a13413df2c4e74820136e739281bb394a73f2d1e6b53066932f50a73310360e5a5c622507d8662dadaef860b3266222129fd645eb74a0207af9bd79a9794f4bd21f32841ce9e1700b0b049cfadb760993fcfc7c65eca63904aa197df306cad8720b1b228484629cf967d808c13f6caef94a9</span><br><span class="line">    e &#x3D; 3</span><br><span class="line">    d&#x3D;0x603d033f2ef6c759aec839f132a45215fc8a635b757f3951a731fe60bc6729b3bcf819b57abfcaba3a93e9edef766c0d499cad3f7adb306bcf1645cfb63400e3</span><br><span class="line"></span><br><span class="line">    beta &#x3D; 0.5</span><br><span class="line">    epsilon &#x3D; beta^2&#x2F;7</span><br><span class="line"></span><br><span class="line">    nbits &#x3D; n.nbits()</span><br><span class="line">	print &quot;nbits:%d:&quot;%(nbits)</span><br><span class="line">    #kbits &#x3D; floor(nbits*(beta^2+epsilon))</span><br><span class="line">	kbits &#x3D; nbits - d.nbits()-1</span><br><span class="line">    d0 &#x3D; d &amp; (2^kbits-1)</span><br><span class="line">    print &quot;lower %d bits (of %d bits) is given&quot; % (kbits, nbits)</span><br><span class="line"></span><br><span class="line">    p &#x3D; find_p(d0, kbits, e, n)</span><br><span class="line">    print &quot;found p: %d&quot; % p</span><br><span class="line">    q &#x3D; n&#x2F;&#x2F;p</span><br><span class="line">    print d</span><br><span class="line">    print inverse_mod(e, (p-1)*(q-1))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">p&#x3D;11225675567380871009570101516613347989321681194686379697181792843475612230559123178043068043743341164294959005139360852241393871718562719024517338855867479</span><br><span class="line">n&#x3D;0xd463feb999c9292e25acd7f98d49a13413df2c4e74820136e739281bb394a73f2d1e6b53066932f50a73310360e5a5c622507d8662dadaef860b3266222129fd645eb74a0207af9bd79a9794f4bd21f32841ce9e1700b0b049cfadb760993fcfc7c65eca63904aa197df306cad8720b1b228484629cf967d808c13f6caef94a9</span><br><span class="line">e &#x3D; 3</span><br><span class="line">q&#x3D;n&#x2F;p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d&#x3D;99430503515013903040291384133470968970466103991571343492764814780967090203742450771166104729697611017493494950675760654484422260868428264884630250537959791201255204527110189941039822089612031446149334262602063427352960800355020085981806048749599222109448518162553849621230522535730119500009520776075508187363</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import gmpy2</span><br><span class="line">p&#x3D;11225675567380871009570101516613347989321681194686379697181792843475612230559123178043068043743341164294959005139360852241393871718562719024517338855867479</span><br><span class="line">n&#x3D;0xd463feb999c9292e25acd7f98d49a13413df2c4e74820136e739281bb394a73f2d1e6b53066932f50a73310360e5a5c622507d8662dadaef860b3266222129fd645eb74a0207af9bd79a9794f4bd21f32841ce9e1700b0b049cfadb760993fcfc7c65eca63904aa197df306cad8720b1b228484629cf967d808c13f6caef94a9</span><br><span class="line">e &#x3D; 3</span><br><span class="line">c&#x3D;0xcaeeb38516d642a19550fa863173f4695c3b44bd5a5554b1e93cfb690d5c1de531b7f1187f7d8c8c11da38af025f19d393033d0ca801e15d6d8441098485f13ab988d09ef1f4f5a735e19780c823cf77415884c33a1f7908cf4229874c082eb7ceb776bafb182b86fdabd29b07bcb8e3f2f50ee4cc0f323e8d9ce320139bcd27</span><br><span class="line">d&#x3D;99430503515013903040291384133470968970466103991571343492764814780967090203742450771166104729697611017493494950675760654484422260868428264884630250537959791201255204527110189941039822089612031446149334262602063427352960800355020085981806048749599222109448518162553849621230522535730119500009520776075508187363</span><br><span class="line">print(d)</span><br><span class="line">m &#x3D; gmpy2.powmod(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">from  libnum  import s2n,n2s</span><br><span class="line">print(n2s(m))</span><br></pre></td></tr></table></figure>













<h5 id="当知道明文-m-的高位或低位时"><a href="#当知道明文-m-的高位或低位时" class="headerlink" title="当知道明文 m 的高位或低位时"></a>当知道明文 m 的高位或低位时</h5><p>即使知道明文 m 的某些位，也可以基于相应的密文恢复 m 的值。</p>
<p>当已知明文 m 的高位约为 n 位数的（1-1 /e）时，令其余位为 0 <code>mbar</code>。当相应的密文为 c 时，<code>f(x) = (mbar + x)^e - c (mod n)</code>可以通过找到的解来获得满足此要求的 f（x）的值，即 m。这<code>b = n</code>是因为是这种情况<code>β = 1</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># partial_m.sage</span><br><span class="line"></span><br><span class="line">n &#x3D; 0x00bef498e6eb2cffe71312da47ab89d2c47db7438ea2cfa992ddddbc2a01978001fc51e286e6ebf028396cdb8b3323c60e6b9d50cd84187cf7f48e3875a2f0890f70b02333ad89db2923863ce146562286f63fb0a1d0198e3a6862ba5ac12e85a5c6d0d27cb1c81bdf69cc5bc95b8001a2f744517f9437b4ddd5a076fc0e9a5de1a7a268c40f31aa29e8dc27c0b3a182299ca7a9335b4bd4585452f6107c238e486c98dd73a5f9862e9e80b152f53381c72f897107551c281259ac3ee32c4b4f46cc03127d1bf699acd0266f3c6729253c70da0c69b1560fa172735709866b375b6eba294e1ce8b46fba798ba380080b4bf9603998cac199d9cd46e30ae8da9e7f</span><br><span class="line"></span><br><span class="line">e &#x3D; 3</span><br><span class="line"></span><br><span class="line">m &#x3D; randrange(n)</span><br><span class="line">c &#x3D; pow(m, e, n)</span><br><span class="line"></span><br><span class="line">beta &#x3D; 1</span><br><span class="line">epsilon &#x3D; beta^2&#x2F;7</span><br><span class="line"></span><br><span class="line">nbits &#x3D; n.nbits()</span><br><span class="line">kbits &#x3D; floor(nbits*(beta^2&#x2F;e-epsilon))</span><br><span class="line">mbar &#x3D; m &amp; (2^nbits-2^kbits)</span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (nbits-kbits, nbits)</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; (mbar + x)^e - c</span><br><span class="line"></span><br><span class="line">print m</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;1)[0]  # find root &lt; 2^kbits with factor &#x3D; n</span><br><span class="line">print mbar + x0</span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 1 [+]n&#x3D;0x2519834a6cc3bf25d078caefc5358e41c726a7a56270e425e21515d1b195b248b82f4189a0b621694586bb254e27010ee4376a849bb373e5e3f2eb622e3e7804d18ddb897463f3516b431e7fc65ec41c42edf736d5940c3139d1e374aed1fc3b70737125e1f540b541a9c671f4bf0ded798d727211116eb8b86cdd6a29aefcc7L </span><br><span class="line">[+]e&#x3D;3 </span><br><span class="line">[+]m&#x3D;random.getrandbits(512) [+]c&#x3D;pow(m,e,n)&#x3D;0x1f6f6a8e61f7b5ad8bef738f4376a96724192d8da1e3689dec7ce5d1df615e0910803317f9bafb6671ffe722e0292ce76cca399f2af1952dd31a61b37019da9cf27f82c3ecd4befc03c557efe1a5a29f9bb73c0239f62ed951955718ac0eaa3f60a4c415ef064ea33bbd61abe127c6fc808c0edb034c52c45bd20a219317fb75L [+]((m&gt;&gt;72)&lt;&lt;72)&#x3D;0xb11ffc4ce423c77035280f1c575696327901daac8a83c057c453973ee5f4e508455648886441c0f3393fe4c922ef1c3a6249c12d21a000000000000000000L </span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blus.King」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;q851579181q&#x2F;article&#x2F;details&#x2F;90645041</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; 0x2519834a6cc3bf25d078caefc5358e41c726a7a56270e425e21515d1b195b248b82f4189a0b621694586bb254e27010ee4376a849bb373e5e3f2eb622e3e7804d18ddb897463f3516b431e7fc65ec41c42edf736d5940c3139d1e374aed1fc3b70737125e1f540b541a9c671f4bf0ded798d727211116eb8b86cdd6a29aefcc7</span><br><span class="line"></span><br><span class="line">e &#x3D; 3</span><br><span class="line"></span><br><span class="line">m &#x3D; randrange(n)</span><br><span class="line">c &#x3D; pow(m, e, n)</span><br><span class="line"></span><br><span class="line">beta &#x3D; 1</span><br><span class="line">epsilon &#x3D; beta^2&#x2F;7</span><br><span class="line"></span><br><span class="line">nbits &#x3D; n.nbits()</span><br><span class="line">kbits &#x3D; floor(nbits*(beta^2&#x2F;e-epsilon))</span><br><span class="line">mbar &#x3D; 0xb11ffc4ce423c77035280f1c575696327901daac8a83c057c453973ee5f4e508455648886441c0f3393fe4c922ef1c3a6249c12d21a000000000000000000</span><br><span class="line">c &#x3D; 0x1f6f6a8e61f7b5ad8bef738f4376a96724192d8da1e3689dec7ce5d1df615e0910803317f9bafb6671ffe722e0292ce76cca399f2af1952dd31a61b37019da9cf27f82c3ecd4befc03c557efe1a5a29f9bb73c0239f62ed951955718ac0eaa3f60a4c415ef064ea33bbd61abe127c6fc808c0edb034c52c45bd20a219317fb75</span><br><span class="line"></span><br><span class="line">print &quot;upper %d bits (of %d bits) is given&quot; % (nbits-kbits, nbits)</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; (mbar + x)^e - c</span><br><span class="line"></span><br><span class="line">print m</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;1)[0]  # find root &lt; 2^kbits with factor &#x3D; n</span><br><span class="line">print mbar + x0</span><br></pre></td></tr></table></figure>





<h6 id="Stereotyped-messages"><a href="#Stereotyped-messages" class="headerlink" title="Stereotyped messages"></a>Stereotyped messages</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;coppersmith.sage&quot;)</span><br><span class="line">N &#x3D; #N的值</span><br><span class="line">e &#x3D; 3 #e的值</span><br><span class="line">m &#x3D; #m的大概值</span><br><span class="line">c &#x3D; #c的值</span><br><span class="line">ZmodN &#x3D; Zmod(N)</span><br><span class="line">P.&lt;x&gt; &#x3D; PolynomialRing(ZmodN)</span><br><span class="line">f &#x3D; (m + x)^e - c</span><br><span class="line">dd &#x3D; f.degree()</span><br><span class="line">beta &#x3D; 1</span><br><span class="line">epsilon &#x3D; beta &#x2F; 7</span><br><span class="line">mm &#x3D; ceil(beta**2 &#x2F; (dd * epsilon))</span><br><span class="line">tt &#x3D; floor(dd * mm * ((1&#x2F;beta) - 1))</span><br><span class="line">XX &#x3D; ceil(N**((beta**2&#x2F;dd) - epsilon))</span><br><span class="line">roots &#x3D; coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX)</span><br></pre></td></tr></table></figure>

<p> 求出的结果是与 m 的差值，既f(x)=(m+x)^e-c<em>f</em>(<em>x</em>)=(<em>m</em>+<em>x</em>)<em>e</em>−<em>c</em> 的根<br>特别的，XX 是根的上界，根据你知道的 m 的位数进行调整 </p>
<h6 id="Lattice-based-attacks"><a href="#Lattice-based-attacks" class="headerlink" title="Lattice based attacks"></a>Lattice based attacks</h6><h5 id="Coppersmith’s-Short-Pad-Attack-amp-Franklin-Reiter-Related-Message-Attack-明文高位相同-明文存在线性关系"><a href="#Coppersmith’s-Short-Pad-Attack-amp-Franklin-Reiter-Related-Message-Attack-明文高位相同-明文存在线性关系" class="headerlink" title="Coppersmith’s Short Pad Attack &amp; Franklin-Reiter Related Message Attack 明文高位相同 明文存在线性关系"></a>Coppersmith’s Short Pad Attack &amp; Franklin-Reiter Related Message Attack 明文高位相同 明文存在线性关系</h5><p> 到目前为止，这些示例假定您已经知道要查找的一些值。作为其他模式，当两个密文的明文的高位与 n（1-1 /e 2）的位数相同时，可以从它们获得明文。具体地，过程如下。 </p>
<ol>
<li><code>g1 = x^e - c1</code>和<code>g2 = (x+y)^e - c2</code>所述<a href="https://ja.wikipedia.org/wiki/終結式" target="_blank" rel="noopener">所得（合成）</a>计算，得到 y 的值作为其根</li>
<li>替换 y 的值，找到 g1（x）和 g2（x）的最大公约数，并以 m1 为根</li>
<li><code>m2 = m1 + y</code> 多获得 m2</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"># coppersmiths_short_pad_attack.sage</span><br><span class="line"></span><br><span class="line">def short_pad_attack(c1, c2, e, n):</span><br><span class="line">    PRxy.&lt;x,y&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    PRx.&lt;xn&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    PRZZ.&lt;xz,yz&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">    g1 &#x3D; x^e - c1</span><br><span class="line">    g2 &#x3D; (x+y)^e - c2</span><br><span class="line"></span><br><span class="line">    q1 &#x3D; g1.change_ring(PRZZ)</span><br><span class="line">    q2 &#x3D; g2.change_ring(PRZZ)</span><br><span class="line"></span><br><span class="line">    h &#x3D; q2.resultant(q1)</span><br><span class="line">    h &#x3D; h.univariate_polynomial()</span><br><span class="line">    h &#x3D; h.change_ring(PRx).subs(y&#x3D;xn)</span><br><span class="line">    h &#x3D; h.monic()</span><br><span class="line"></span><br><span class="line">    kbits &#x3D; n.nbits()&#x2F;&#x2F;(2*e*e)</span><br><span class="line">    diff &#x3D; h.small_roots(X&#x3D;2^kbits, beta&#x3D;0.5)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.5</span><br><span class="line"></span><br><span class="line">    return diff</span><br><span class="line"></span><br><span class="line">def related_message_attack(c1, c2, diff, e, n):</span><br><span class="line">    PRx.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">    g1 &#x3D; x^e - c1</span><br><span class="line">    g2 &#x3D; (x+diff)^e - c2</span><br><span class="line"></span><br><span class="line">    def gcd(g1, g2):</span><br><span class="line">        while g2:</span><br><span class="line">            g1, g2 &#x3D; g2, g1 % g2</span><br><span class="line">        return g1.monic()</span><br><span class="line"></span><br><span class="line">    return -gcd(g1, g2)[0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    n &#x3D; 0x00bef498e6eb2cffe71312da47ab89d2c47db7438ea2cfa992ddddbc2a01978001fc51e286e6ebf028396cdb8b3323c60e6b9d50cd84187cf7f48e3875a2f0890f70b02333ad89db2923863ce146562286f63fb0a1d0198e3a6862ba5ac12e85a5c6d0d27cb1c81bdf69cc5bc95b8001a2f744517f9437b4ddd5a076fc0e9a5de1a7a268c40f31aa29e8dc27c0b3a182299ca7a9335b4bd4585452f6107c238e486c98dd73a5f9862e9e80b152f53381c72f897107551c281259ac3ee32c4b4f46cc03127d1bf699acd0266f3c6729253c70da0c69b1560fa172735709866b375b6eba294e1ce8b46fba798ba380080b4bf9603998cac199d9cd46e30ae8da9e7f</span><br><span class="line">    e &#x3D; 3</span><br><span class="line"></span><br><span class="line">    nbits &#x3D; n.nbits()</span><br><span class="line">    kbits &#x3D; nbits&#x2F;&#x2F;(2*e*e)</span><br><span class="line">    print &quot;upper %d bits (of %d bits) is same&quot; % (nbits-kbits, nbits)</span><br><span class="line"></span><br><span class="line">    # ^^ &#x3D; bit-wise XOR</span><br><span class="line">    # http:&#x2F;&#x2F;doc.sagemath.org&#x2F;html&#x2F;en&#x2F;faq&#x2F;faq-usage.html#how-do-i-use-the-bitwise-xor-operator-in-sage</span><br><span class="line">    m1 &#x3D; randrange(2^nbits)</span><br><span class="line">    m2 &#x3D; m1 ^^ randrange(2^kbits)</span><br><span class="line">    c1 &#x3D; pow(m1, e, n)</span><br><span class="line">    c2 &#x3D; pow(m2, e, n)</span><br><span class="line"></span><br><span class="line">    diff &#x3D; short_pad_attack(c1, c2, e, n)</span><br><span class="line">    print &quot;difference of two messages is %d&quot; % diff</span><br><span class="line"></span><br><span class="line">    print m1</span><br><span class="line">    m1 &#x3D; related_message_attack(c1, c2, diff, e, n)</span><br><span class="line">    print m1</span><br><span class="line">    print m2</span><br><span class="line">    print m1 + diff</span><br></pre></td></tr></table></figure>



<blockquote>
<p>[+]Generating challenge 5  n=0xf9526aad4d41c9b28f8bae279c7ef6b07d729d1f56e530219851f656ad521218815bdccb15167a25633a2f76969fccd3fe1ef379ded08d1a9c3307f680e952956d2b3d04cc50040efb30e40bf2562aae4b05b8ec0d5e0e0ea5fdc1b00b80dee9b6de1d77d41d8d040d3465c89133d9af23b1d43f57e70606e3433d35a47e2edL  e=3 m=random.getrandbits(512) c=pow(<strong>m</strong>,e,n)=0x798841c574b7c88ce1430d4b02bac01fc9368c71a7966176b22f9dc2e0c2f6d4d5b8a9e10dbcaa4584e667ef1afd213b78c2bdc16ba5ab909c2de2fe5a7a5fa36a390bdccf794451cd9db8489ed7870efa4a4d7d1cacacfec92e81f6bb955a4ef5d71d80631c0726d22ec3d5b115de7ff42f22e67854b59ed816e06485ab523L  x=pow(<strong>m+1</strong>,e,n)=0xe92c4c99052fa3c4bb5e54477b0afe8e18da37255269f070ffa6824492a87153e428fa4ed839b7f3249966259a0c88641185594fc2fa4881cf32b7af5b18baa6f5200453ee80e38c74dbeb90f32118e4f33e636a808e44f27e09286d109ee8f41765ad64c7afea9775974d78a80e0977a37689c7f15a23a83a87b1f5bdbcdecL  “[-]long_to_bytes(m).encode(‘hex’)=”<br>————————————————<br>版权声明：本文为CSDN博主「Blus.King」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/q851579181q/article/details/90645041" target="_blank" rel="noopener">https://blog.csdn.net/q851579181q/article/details/90645041</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">def getM2(a,b,c1,c2,n):</span><br><span class="line">    a3 &#x3D; pow(a,3,n)</span><br><span class="line">    b3&#x3D;pow(b,3,n)</span><br><span class="line">    first&#x3D;c1-a3*c2+2*b3</span><br><span class="line">    first&#x3D;first%n</span><br><span class="line">    second&#x3D;3*b*(a3*c2-b3)</span><br><span class="line">    second&#x3D;second%n</span><br><span class="line">    third&#x3D;second*gmpy2.invert(first,n)</span><br><span class="line">    third&#x3D;third%n</span><br><span class="line">    fourth&#x3D;(third+b)*gmpy2.invert(a,n)</span><br><span class="line">    return fourth%n</span><br><span class="line">#y&#x3D;ax+b</span><br><span class="line">a&#x3D;1</span><br><span class="line"># b&#x3D;1</span><br><span class="line">b&#x3D;-1</span><br><span class="line">padding2&#x3D;b</span><br><span class="line">n&#x3D;0xf9526aad4d41c9b28f8bae279c7ef6b07d729d1f56e530219851f656ad521218815bdccb15167a25633a2f76969fccd3fe1ef379ded08d1a9c3307f680e952956d2b3d04cc50040efb30e40bf2562aae4b05b8ec0d5e0e0ea5fdc1b00b80dee9b6de1d77d41d8d040d3465c89133d9af23b1d43f57e70606e3433d35a47e2ed</span><br><span class="line">c1&#x3D;0x798841c574b7c88ce1430d4b02bac01fc9368c71a7966176b22f9dc2e0c2f6d4d5b8a9e10dbcaa4584e667ef1afd213b78c2bdc16ba5ab909c2de2fe5a7a5fa36a390bdccf794451cd9db8489ed7870efa4a4d7d1cacacfec92e81f6bb955a4ef5d71d80631c0726d22ec3d5b115de7ff42f22e67854b59ed816e06485ab523</span><br><span class="line">c2&#x3D;0xe92c4c99052fa3c4bb5e54477b0afe8e18da37255269f070ffa6824492a87153e428fa4ed839b7f3249966259a0c88641185594fc2fa4881cf32b7af5b18baa6f5200453ee80e38c74dbeb90f32118e4f33e636a808e44f27e09286d109ee8f41765ad64c7afea9775974d78a80e0977a37689c7f15a23a83a87b1f5bdbcdec</span><br><span class="line">m &#x3D; getM2(a,b,c1,c2,n)-padding2</span><br><span class="line"># m&#x3D;m-2</span><br><span class="line"># 不知道为什么还要减2</span><br><span class="line"># #m &#x3D; getM2(a,b,c1,c2,n)-padding2</span><br><span class="line">print libnum.n2s(m)</span><br><span class="line">print m</span><br></pre></td></tr></table></figure>





<h5 id="Boneh-and-Durfee-attack"><a href="#Boneh-and-Durfee-attack" class="headerlink" title="Boneh and Durfee attack"></a>Boneh and Durfee attack</h5><p>d 较小时，满足 d&lt;N^0.292d&lt;N0.292  Boneh and Durfee attack 比 Wiener’s Attack 要强一些</p>
<p><strong>e非常大接近于N</strong>，跟低解密指数攻击类似，比低解密指数攻击更强，可以解决d&lt;N的0.292次方的问题</p>
<blockquote>
<p>[+]Generating challenge 6 [+]n=0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L [+]d=random.getrandbits(1024*0.270)</p>
<p> [+]e=invmod(d,phin) [+]hex(e)=0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL [+]m=random.getrandbits(512) [+]c=pow(m,e,n)=0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL [-]long_to_bytes(m).encode(‘hex’)=<br>————————————————<br>版权声明：本文为CSDN博主「Blus.King」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/q851579181q/article/details/90645041" target="_blank" rel="noopener">https://blog.csdn.net/q851579181q/article/details/90645041</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">############################################</span><br><span class="line"># Config</span><br><span class="line">##########################################</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Setting debug to true will display more informations</span><br><span class="line">about the lattice, the bounds, the vectors...</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">debug &#x3D; True</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Setting strict to true will stop the algorithm (and</span><br><span class="line">return (-1, -1)) if we don&#39;t have a correct </span><br><span class="line">upperbound on the determinant. Note that this </span><br><span class="line">doesn&#39;t necesseraly mean that no solutions </span><br><span class="line">will be found since the theoretical upperbound is</span><br><span class="line">usualy far away from actual results. That is why</span><br><span class="line">you should probably use &#96;strict &#x3D; False&#96;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">strict &#x3D; False</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">This is experimental, but has provided remarkable results</span><br><span class="line">so far. It tries to reduce the lattice as much as it can</span><br><span class="line">while keeping its efficiency. I see no reason not to use</span><br><span class="line">this option, but if things don&#39;t work, you should try</span><br><span class="line">disabling it</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">helpful_only &#x3D; True</span><br><span class="line">dimension_min &#x3D; 7 # stop removing if lattice reaches that dimension</span><br><span class="line"></span><br><span class="line">############################################</span><br><span class="line"># Functions</span><br><span class="line">##########################################</span><br><span class="line"></span><br><span class="line"># display stats on helpful vectors</span><br><span class="line">def helpful_vectors(BB, modulus):</span><br><span class="line">    nothelpful &#x3D; 0</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        if BB[ii,ii] &gt;&#x3D; modulus:</span><br><span class="line">            nothelpful +&#x3D; 1</span><br><span class="line"></span><br><span class="line">    print nothelpful, &quot;&#x2F;&quot;, BB.dimensions()[0], &quot; vectors are not helpful&quot;</span><br><span class="line"></span><br><span class="line"># display matrix picture with 0 and X</span><br><span class="line">def matrix_overview(BB, bound):</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        a &#x3D; (&#39;%02d &#39; % ii)</span><br><span class="line">        for jj in range(BB.dimensions()[1]):</span><br><span class="line">            a +&#x3D; &#39;0&#39; if BB[ii,jj] &#x3D;&#x3D; 0 else &#39;X&#39;</span><br><span class="line">            if BB.dimensions()[0] &lt; 60:</span><br><span class="line">                a +&#x3D; &#39; &#39;</span><br><span class="line">        if BB[ii, ii] &gt;&#x3D; bound:</span><br><span class="line">            a +&#x3D; &#39;~&#39;</span><br><span class="line">        print a</span><br><span class="line"></span><br><span class="line"># tries to remove unhelpful vectors</span><br><span class="line"># we start at current &#x3D; n-1 (last vector)</span><br><span class="line">def remove_unhelpful(BB, monomials, bound, current):</span><br><span class="line">    # end of our recursive function</span><br><span class="line">    if current &#x3D;&#x3D; -1 or BB.dimensions()[0] &lt;&#x3D; dimension_min:</span><br><span class="line">        return BB</span><br><span class="line"></span><br><span class="line">    # we start by checking from the end</span><br><span class="line">    for ii in range(current, -1, -1):</span><br><span class="line">        # if it is unhelpful:</span><br><span class="line">        if BB[ii, ii] &gt;&#x3D; bound:</span><br><span class="line">            affected_vectors &#x3D; 0</span><br><span class="line">            affected_vector_index &#x3D; 0</span><br><span class="line">            # let&#39;s check if it affects other vectors</span><br><span class="line">            for jj in range(ii + 1, BB.dimensions()[0]):</span><br><span class="line">                # if another vector is affected:</span><br><span class="line">                # we increase the count</span><br><span class="line">                if BB[jj, ii] !&#x3D; 0:</span><br><span class="line">                    affected_vectors +&#x3D; 1</span><br><span class="line">                    affected_vector_index &#x3D; jj</span><br><span class="line"></span><br><span class="line">            # level:0</span><br><span class="line">            # if no other vectors end up affected</span><br><span class="line">            # we remove it</span><br><span class="line">            if affected_vectors &#x3D;&#x3D; 0:</span><br><span class="line">                print &quot;* removing unhelpful vector&quot;, ii</span><br><span class="line">                BB &#x3D; BB.delete_columns([ii])</span><br><span class="line">                BB &#x3D; BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB &#x3D; remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                return BB</span><br><span class="line"></span><br><span class="line">            # level:1</span><br><span class="line">            # if just one was affected we check</span><br><span class="line">            # if it is affecting someone else</span><br><span class="line">            elif affected_vectors &#x3D;&#x3D; 1:</span><br><span class="line">                affected_deeper &#x3D; True</span><br><span class="line">                for kk in range(affected_vector_index + 1, BB.dimensions()[0]):</span><br><span class="line">                    # if it is affecting even one vector</span><br><span class="line">                    # we give up on this one</span><br><span class="line">                    if BB[kk, affected_vector_index] !&#x3D; 0:</span><br><span class="line">                        affected_deeper &#x3D; False</span><br><span class="line">                # remove both it if no other vector was affected and</span><br><span class="line">                # this helpful vector is not helpful enough</span><br><span class="line">                # compared to our unhelpful one</span><br><span class="line">                if affected_deeper and abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    print &quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index</span><br><span class="line">                    BB &#x3D; BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB &#x3D; BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB &#x3D; remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                    return BB</span><br><span class="line">    # nothing happened</span><br><span class="line">    return BB</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot; </span><br><span class="line">Returns:</span><br><span class="line">* 0,0   if it fails</span><br><span class="line">* -1,-1 if &#96;strict&#x3D;true&#96;, and determinant doesn&#39;t bound</span><br><span class="line">* x0,y0 the solutions of &#96;pol&#96;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def boneh_durfee(pol, modulus, mm, tt, XX, YY):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Boneh and Durfee revisited by Herrmann and May</span><br><span class="line">    </span><br><span class="line">    finds a solution if:</span><br><span class="line">    * d &lt; N^delta</span><br><span class="line">    * |x| &lt; e^delta</span><br><span class="line">    * |y| &lt; e^0.5</span><br><span class="line">    whenever delta &lt; 1 - sqrt(2)&#x2F;2 ~ 0.292</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    # substitution (Herrman and May)</span><br><span class="line">    PR.&lt;u, x, y&gt; &#x3D; PolynomialRing(ZZ)</span><br><span class="line">    Q &#x3D; PR.quotient(x*y + 1 - u) # u &#x3D; xy + 1</span><br><span class="line">    polZ &#x3D; Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU &#x3D; XX*YY + 1</span><br><span class="line"></span><br><span class="line">    # x-shifts</span><br><span class="line">    gg &#x3D; []</span><br><span class="line">    for kk in range(mm + 1):</span><br><span class="line">        for ii in range(mm - kk + 1):</span><br><span class="line">            xshift &#x3D; x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    # x-shifts list of monomials</span><br><span class="line">    monomials &#x3D; []</span><br><span class="line">    for polynomial in gg:</span><br><span class="line">        for monomial in polynomial.monomials():</span><br><span class="line">            if monomial not in monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    # y-shifts (selected by Herrman and May)</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm&#x2F;tt) * jj, mm + 1):</span><br><span class="line">            yshift &#x3D; y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift &#x3D; Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) # substitution</span><br><span class="line">    </span><br><span class="line">    # y-shifts list of monomials</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm&#x2F;tt) * jj, mm + 1):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    # construct lattice B</span><br><span class="line">    nn &#x3D; len(monomials)</span><br><span class="line">    BB &#x3D; Matrix(ZZ, nn)</span><br><span class="line">    for ii in range(nn):</span><br><span class="line">        BB[ii, 0] &#x3D; gg[ii](0, 0, 0)</span><br><span class="line">        for jj in range(1, ii + 1):</span><br><span class="line">            if monomials[jj] in gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] &#x3D; gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    # Prototype to reduce the lattice</span><br><span class="line">    if helpful_only:</span><br><span class="line">        # automatically remove</span><br><span class="line">        BB &#x3D; remove_unhelpful(BB, monomials, modulus^mm, nn-1)</span><br><span class="line">        # reset dimension</span><br><span class="line">        nn &#x3D; BB.dimensions()[0]</span><br><span class="line">        if nn &#x3D;&#x3D; 0:</span><br><span class="line">            print &quot;failure&quot;</span><br><span class="line">            return 0,0</span><br><span class="line"></span><br><span class="line">    # check if vectors are helpful</span><br><span class="line">    if debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    </span><br><span class="line">    # check if determinant is correctly bounded</span><br><span class="line">    det &#x3D; BB.det()</span><br><span class="line">    bound &#x3D; modulus^(mm*nn)</span><br><span class="line">    if det &gt;&#x3D; bound:</span><br><span class="line">        print &quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span><br><span class="line">        print &quot;Try with highers m and t.&quot;</span><br><span class="line">        if debug:</span><br><span class="line">            diff &#x3D; (log(det) - log(bound)) &#x2F; log(2)</span><br><span class="line">            print &quot;size det(L) - size e^(m*n) &#x3D; &quot;, floor(diff)</span><br><span class="line">        if strict:</span><br><span class="line">            return -1, -1</span><br><span class="line">    else:</span><br><span class="line">        print &quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span><br><span class="line"></span><br><span class="line">    # display the lattice basis</span><br><span class="line">    if debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    # LLL</span><br><span class="line">    if debug:</span><br><span class="line">        print &quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span><br><span class="line"></span><br><span class="line">    BB &#x3D; BB.LLL()</span><br><span class="line"></span><br><span class="line">    if debug:</span><br><span class="line">        print &quot;LLL is done!&quot;</span><br><span class="line"></span><br><span class="line">    # transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span><br><span class="line">    if debug:</span><br><span class="line">        print &quot;looking for independent vectors in the lattice&quot;</span><br><span class="line">    found_polynomials &#x3D; False</span><br><span class="line">    </span><br><span class="line">    for pol1_idx in range(nn - 1):</span><br><span class="line">        for pol2_idx in range(pol1_idx + 1, nn):</span><br><span class="line">            # for i and j, create the two polynomials</span><br><span class="line">            PR.&lt;w,z&gt; &#x3D; PolynomialRing(ZZ)</span><br><span class="line">            pol1 &#x3D; pol2 &#x3D; 0</span><br><span class="line">            for jj in range(nn):</span><br><span class="line">                pol1 +&#x3D; monomials[jj](w*z+1,w,z) * BB[pol1_idx, jj] &#x2F; monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 +&#x3D; monomials[jj](w*z+1,w,z) * BB[pol2_idx, jj] &#x2F; monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            # resultant</span><br><span class="line">            PR.&lt;q&gt; &#x3D; PolynomialRing(ZZ)</span><br><span class="line">            rr &#x3D; pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            # are these good polynomials?</span><br><span class="line">            if rr.is_zero() or rr.monomials() &#x3D;&#x3D; [1]:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                print &quot;found them, using vectors&quot;, pol1_idx, &quot;and&quot;, pol2_idx</span><br><span class="line">                found_polynomials &#x3D; True</span><br><span class="line">                break</span><br><span class="line">        if found_polynomials:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    if not found_polynomials:</span><br><span class="line">        print &quot;no independant vectors could be found. This should very rarely happen...&quot;</span><br><span class="line">        return 0, 0</span><br><span class="line">    </span><br><span class="line">    rr &#x3D; rr(q, q)</span><br><span class="line"></span><br><span class="line">    # solutions</span><br><span class="line">    soly &#x3D; rr.roots()</span><br><span class="line"></span><br><span class="line">    if len(soly) &#x3D;&#x3D; 0:</span><br><span class="line">        print &quot;Your prediction (delta) is too small&quot;</span><br><span class="line">        return 0, 0</span><br><span class="line"></span><br><span class="line">    soly &#x3D; soly[0][0]</span><br><span class="line">    ss &#x3D; pol1(q, soly)</span><br><span class="line">    solx &#x3D; ss.roots()[0][0]</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    return solx, soly</span><br><span class="line"></span><br><span class="line">def example():</span><br><span class="line">    ############################################</span><br><span class="line">    # How To Use This Script</span><br><span class="line">    ##########################################</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # The problem to solve (edit the following values)</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # the modulus</span><br><span class="line">    N &#x3D; 0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span><br><span class="line">    # the public exponent</span><br><span class="line">    e &#x3D; 0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span><br><span class="line">    # the cipher</span><br><span class="line">    c &#x3D; 0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    # the hypothesis on the private exponent (the theoretical maximum is 0.292)</span><br><span class="line">    delta &#x3D; .18 # this means that d &lt; N^delta</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Lattice (tweak those values)</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # you should tweak this (after a first run), (e.g. increment it until a solution is found)</span><br><span class="line">    m &#x3D; 4 # size of the lattice (bigger the better&#x2F;slower)</span><br><span class="line"></span><br><span class="line">    # you need to be a lattice master to tweak these</span><br><span class="line">    t &#x3D; int((1-2*delta) * m)  # optimization from Herrmann and May</span><br><span class="line">    X &#x3D; 2*floor(N^delta)  # this _might_ be too much</span><br><span class="line">    Y &#x3D; floor(N^(1&#x2F;2))    # correct if p, q are ~ same size</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Don&#39;t touch anything below</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # Problem put in equation</span><br><span class="line">    P.&lt;x,y&gt; &#x3D; PolynomialRing(ZZ)</span><br><span class="line">    A &#x3D; int((N+1)&#x2F;2)</span><br><span class="line">    pol &#x3D; 1 + x * (A + y)</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Find the solutions!</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # Checking bounds</span><br><span class="line">    if debug:</span><br><span class="line">        print &quot;&#x3D;&#x3D;&#x3D; checking values &#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line">        print &quot;* delta:&quot;, delta</span><br><span class="line">        print &quot;* delta &lt; 0.292&quot;, delta &lt; 0.292</span><br><span class="line">        print &quot;* size of e:&quot;, int(log(e)&#x2F;log(2))</span><br><span class="line">        print &quot;* size of N:&quot;, int(log(N)&#x2F;log(2))</span><br><span class="line">        print &quot;* m:&quot;, m, &quot;, t:&quot;, t</span><br><span class="line"></span><br><span class="line">    # boneh_durfee</span><br><span class="line">    if debug:</span><br><span class="line">        print &quot;&#x3D;&#x3D;&#x3D; running algorithm &#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line">        start_time &#x3D; time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly &#x3D; boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    # found a solution?</span><br><span class="line">    if solx &gt; 0:</span><br><span class="line">        print &quot;&#x3D;&#x3D;&#x3D; solution found &#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line">        if False:</span><br><span class="line">            print &quot;x:&quot;, solx</span><br><span class="line">            print &quot;y:&quot;, soly</span><br><span class="line"></span><br><span class="line">        d &#x3D; int(pol(solx, soly) &#x2F; e)</span><br><span class="line">        m &#x3D; pow(c,d,N)</span><br><span class="line">        print &#39;[-]d is &#39; + str(d)</span><br><span class="line">        print &#39;[-]m is: &#39; + str(m)</span><br><span class="line">        print &#39;[-]hex(m) is: &#39; + &#39;&#123;:x&#125;&#39;.format(int(m))</span><br><span class="line">        print &#39;[-]str(m) is: &#39; + &#39;&#123;:x&#125;&#39;.format(int(m)).decode(&#39;hex&#39;)</span><br><span class="line">    else:</span><br><span class="line">        print &quot;[!]no solution was found!&quot;</span><br><span class="line">        print &#39;[!]All Done!&#39;</span><br><span class="line"></span><br><span class="line">    if debug:</span><br><span class="line">        print(&quot;[!]Timer: %s s&quot; % (time.time() - start_time))</span><br><span class="line">        print &#39;[!]All Done!&#39;</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure>






      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/20/rsa-sage-Coppersmith-%E5%AE%9A%E7%90%86%E6%94%BB%E5%87%BB/" data-id="clmvoc2bf0016jg7k0se5aima" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Coppersmith/" rel="tag">Coppersmith</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rsa/" rel="tag">rsa</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sage/" rel="tag">sage</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/11/21/%E5%B8%B8/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          常
        
      </div>
    </a>
  
  
    <a href="/2019/11/16/2%20XSS/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">XSS</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82/">杂</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coppersmith/" rel="tag">Coppersmith</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphiQL/" rel="tag">GraphiQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" rel="tag">php伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsa/" rel="tag">rsa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sage/" rel="tag">sage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unctf/" rel="tag">unctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xxe/" rel="tag">xxe</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E7%BB%9F%E4%B8%80%E5%9C%BA%E7%90%86%E8%AE%BA/" rel="tag">大统一场理论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="tag">文件包含</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" rel="tag">文件读取</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Coppersmith/" style="font-size: 10px;">Coppersmith</a> <a href="/tags/GraphiQL/" style="font-size: 10px;">GraphiQL</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" style="font-size: 10px;">php伪协议</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/sage/" style="font-size: 10px;">sage</a> <a href="/tags/sql%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">sql注入</a> <a href="/tags/unctf/" style="font-size: 10px;">unctf</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/xxe/" style="font-size: 10px;">xxe</a> <a href="/tags/%E5%A4%A7%E7%BB%9F%E4%B8%80%E5%9C%BA%E7%90%86%E8%AE%BA/" style="font-size: 10px;">大统一场理论</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 20px;">密码学</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">文件上传</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size: 10px;">文件包含</a> <a href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" style="font-size: 10px;">文件读取</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/24/%E5%89%8D%E7%AB%AF/">前端</a>
          </li>
        
          <li>
            <a href="/2023/04/20/%E6%89%94%E5%87%BA%E5%8E%BB%E7%9A%84%E9%83%A8%E5%88%86/">扔出去的部分</a>
          </li>
        
          <li>
            <a href="/2023/04/20/%E4%B8%96%E7%95%8C%E8%A7%82/">世界观</a>
          </li>
        
          <li>
            <a href="/2022/10/01/%E6%9D%82/">杂</a>
          </li>
        
          <li>
            <a href="/2021/05/15/%E7%BD%91%E6%96%87/">网文</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 zhiliya<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>